<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US"><head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<title>Win32 WebCam Program - C++ Tutorials | Dream.In.Code</title>
<meta name="keywords" content="Win32,WebCam,Program,Tutorial,This,guide,through,connecting,webcam,Microsoft,Windows,grabbing,frame,from,camera,later,save">
<meta name="description" content="Win32 WebCam Program: Displays a Webcam Picture, Saves it as a .bmp file">
<meta name="identifier-url" content="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/">
<link rel="canonical" href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/">
<link rel="up" href="http://www.dreamincode.net/forums/forum/48-c-tutorials/">
<link rel="author" href="http://www.dreamincode.net/forums/user/358927-snoopy11/">
<link rel="alternate feed" type="application/rss+xml" title="Dream.In.Code Blogs RSS feed" href="http://www.dreamincode.net/forums/rss/blog/">
<link rel="alternate feed" type="application/rss+xml" title="Programming Forums" href="http://www.dreamincode.net/forums/rss/forums/1-programming-forums/">
<link rel="stylesheet" type="text/css" media="print" href="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/ipb_print.css">
<link rel="stylesheet" type="text/css" media="screen" href="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/index.css">
<!--[if lte IE 7]>
	<link rel="stylesheet" type="text/css" title='Main' media="screen" href="http://cdn3.dreamincode.net/dreamincode/forums/public/style_css/css_5/ipb_ie.css?v=57" />
<![endif]-->
<meta http-equiv="X-UA-Compatible" content="IE=8">
<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="http://www.dreamincode.net/home/favicon.ico">
<link rel="alternate" title="dream.in.code Forums" href="http://www.dreamincode.net/rss/featured.php" type="application/rss+xml">
<link rel="stylesheet" type="text/css" href="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/home_templates2_styles_7.css">
<meta property="fb:page_id" content="62219401412">
<script src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/ga.js" async="" type="text/javascript"></script><script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/jquery.js"></script>
<script type="text/javascript">
		jQuery.noConflict();
		</script>
<script type="text/javascript">
		  //<![CDATA[
		  function loginToggle() {
			var target = document.getElementById("login").getElementsByTagName("div")[0];
			!target.className.match(/ visible/) ? target.className += " visible" : target.className = target.className.replace(/ visible/, "");
			}
		  //]]>
		</script>
<script type="text/javascript">
      jsDebug = 0; /* Must come before JS includes */
      USE_RTE = 0;
      inACP   = false;
    </script>
<script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/index_002.js"></script>
<script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/index.js" charset="iso-8859-1"></script>
<script type="text/javascript">
	var isRTL	= false;
	var rtlIe	= '';
	var rtlFull	= '';
</script>
<script type="text/javascript">
	//<![CDATA[
		/* ---- URLs ---- */
		ipb.vars['base_url'] 			= 'http://www.dreamincode.net/forums/index.php?&';
		ipb.vars['board_url']			= 'http://www.dreamincode.net/forums';
		ipb.vars['loading_img'] 		= 'http://cdn2.dreamincode.net/dreamincode/forums/public/style_images/master/loading.gif';
		ipb.vars['active_app']			= 'forums';
		ipb.vars['upload_url']			= 'http://www.dreamincode.net/forums/uploads';
		/* ---- Member ---- */
		ipb.vars['member_id']			= parseInt( 0 ),
		ipb.vars['is_supmod']			= parseInt( 0 ),
		ipb.vars['is_admin']			= parseInt( 0 ),
		ipb.vars['secure_hash'] 		= '880ea6a14ea49e853634fbdc5015a024';
		ipb.vars['session_id']			= '8c1fcd11132cad946a243a519c281d1f';
		ipb.vars['can_befriend']		= true;
		/* ---- cookies ----- */
		ipb.vars['cookie_id'] 			= 'dic_';
		ipb.vars['cookie_domain'] 		= '.dreamincode.net';
		ipb.vars['cookie_path']			= '/';
		/* ---- Rate imgs ---- */
		ipb.vars['rate_img_on']			= 'http://cdn2.dreamincode.net/dreamincode/forums/public/style_images/master/bullet_star.png';
		ipb.vars['rate_img_off']		= 'http://cdn2.dreamincode.net/dreamincode/forums/public/style_images/master/bullet_star_off.png';
		ipb.vars['rate_img_rated']		= 'http://cdn2.dreamincode.net/dreamincode/forums/public/style_images/master/bullet_star_rated.png';
		/* ---- Uploads ---- */
		ipb.vars['swfupload_swf']		= 'http://www.dreamincode.net/forums/public/js/3rd_party/swfupload/swfupload.swf';
		ipb.vars['swfupload_enabled']	= true;
		ipb.vars['use_swf_upload']		= ( '' == 'flash' ) ? true : false;
		ipb.vars['swfupload_debug']		= false; /* SKINNOTE: Turn off for production */
		/* ---- other ---- */
		ipb.vars['use_live_search'] 	= 0;
		ipb.vars['live_search_limit'] 	= 4;
		ipb.vars['highlight_color']		= "#ade57a";
		ipb.vars['charset']				= "iso-8859-1";
		ipb.vars['use_rte']				= 1;
		ipb.vars['image_resize']		= 1;
		ipb.vars['image_resize_force']  = 500;
		ipb.vars['seo_enabled']			= 1;
		
		ipb.vars['seo_params']			= {"start":"-","end":"\/","varBlock":"\/page__","varSep":"__"};
		
		/* Templates/Language */
		ipb.templates['ajax_loading'] 	= "<div id='ajax_loading'>" + ipb.lang['loading'] + "</div>";
		ipb.templates['close_popup']	= "<img src='http://cdn2.dreamincode.net/dreamincode/forums/public/style_images/master/close_popup.png' alt='x' />";
		ipb.templates['rss_shell']		= new Template("<ul id='rss_menu'>#{items}</ul>");
		ipb.templates['rss_item']		= new Template("<li><a href='#{url}' title='#{title}'>#{title}</a></li>");
		ipb.templates['resized_img']	= new Template("<span>Resized to #{percent}% (was #{width} x #{height}) - Click image to enlarge</span>");
		ipb.templates['m_add_friend']	= new Template("<a href='http://www.dreamincode.net/forums/index.php?app=members&amp;module=profile&amp;section=friends&amp;do=add&amp;member_id=#{id}' title='Add as Friend'><img src='http://cdn2.dreamincode.net/dreamincode/forums/public/style_images/master/user_add.png' alt='Add as Friend' /></a>");
		ipb.templates['m_rem_friend']	= new Template("<a href='http://www.dreamincode.net/forums/index.php?app=members&amp;module=profile&amp;section=friends&amp;do=remove&amp;member_id=#{id}' title='Remove Friend'><img src='http://cdn2.dreamincode.net/dreamincode/forums/public/style_images/master/user_delete.png' alt='Remove Friend' /></a>");
		ipb.templates['autocomplete_wrap'] = new Template("<ul id='#{id}' class='ipb_autocomplete' style='width: 250px;'></ul>");
		ipb.templates['autocomplete_item'] = new Template("<li id='#{id}'><img src='#{img}' alt='' width='#{img_w}' height='#{img_h}' />&nbsp;&nbsp;#{itemvalue}</li>");
		ipb.templates['page_jump']		= new Template("<div id='#{id}_wrap' class='ipbmenu_content'><h3 class='bar'>Jump to page</h3><input type='text' class='input_text' id='#{id}_input' size='8' /> <input type='submit' value='Go' class='input_submit add_folder' id='#{id}_submit' /></div>");
	//]]>
	</script>
<script type="text/javascript">
      Loader.boot();
    </script>
<style type="text/css">
pre { overflow: scroll; max-height:500px; background: white; border: 1px solid #66666; padding: 5px; }
</style>
<script src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/a.htm" type="text/javascript"></script></head>
<body itemscope="" itemtype="http://schema.org/WebPage">
<div style="color: white; height: 27px; margin: 0px auto; border-bottom: 0px solid white; padding: 0px; text-align: center; font-size: 14px; background-color: #1B50E0; font-weight: bolder;">
<div class="lqm_ad" lqm_publisher="lqm.dreamincode.site" lqm_zone="RON" lqm_format="1x6"></div>
</div>
<div id="header">
<h1 id="logo" style="width: 525px;"><a href="http://www.dreamincode.net/" rel="home"><img alt="&lt;/Dream.In.Code&gt;: Programming &amp; Web Development Community" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/logo_2011.gif" width="264" height="110"></a></h1>
<div style="height: 110px;">
<div style="padding-top: 30px; padding-right: 10px; float: right;">
<form style="margin: 0pt;" id="cse-search-box">
<span style="float: left; font-size: 24px; padding-top: 5px; padding-right: 5px; color: white; font-weight: bolder; text-shadow: 1px 1px 1px rgb(0, 0, 0);">Search:</span>
<input name="q" id="query" size="18" style="font-size: 20px; margin-top: 5px; border: 1px solid; border-radius: 5px 5px 5px 5px; background: url(&quot;http://www.google.com/cse/intl/en/images/google_custom_search_watermark.gif&quot;) no-repeat scroll left center rgb(255, 255, 255);" type="text">
<input name="sa" value="Search" style="color: white; background: none repeat scroll 0% 0% rgb(48, 48, 48); font-weight: bolder; border: 1px solid black; margin: 0px 0px 0px 5px; padding: 5px; border-radius: 5px 5px 5px 5px; position: relative; top: -3px;" type="submit">
</form>
<script type="text/javascript">
 					var f = document.getElementById('cse-search-box');
					var q = f.q;
					    var b = function() {
						  if (q.value == '') {
							q.style.background = '#FFFFFF url(http:\x2F\x2Fwww.google.com\x2Fcse\x2Fintl\x2Fen\x2Fimages\x2Fgoogle_custom_search_watermark.gif) left no-repeat';
						  }
						};

						var f = function() {
						  q.style.background = '#ffffff';
						};
						window.onload = b;
						q.onfocus = f;
						q.onblur = b;

					</script>
<div style="text-align: right; clear: both;">
<a href="http://www.dreamincode.net/forums/index.php?app=core&amp;module=search" style="text-decoration: none;"><span style="font-size: 11px; color: rgb(255, 255, 255); font-weight: bold; text-decoration: underline; text-align: right;">Advanced Forum Search</span></a>
</div>
</div>
</div>
<div id="navigation-login-register">
<ul class="navigation">
<li class="first"><a href="http://www.dreamincode.net/forums/">Forums</a></li>
<li>
<a href="http://www.dreamincode.net/forums/forum/76-programming-help/">Programming</a>
</li>
<li>
<a href="http://www.dreamincode.net/forums/forum/74-web-development/">Web Development</a>
</li>
<li><a href="http://www.dreamincode.net/forums/forum/25-computer-support-operating-systems/">Computers</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/78-programming-tutorials/">Tutorials</a></li>
<li><a href="http://www.dreamincode.net/code/">Snippets</a></li>
<li><a href="http://www.dreamincode.net/forums/?automodule=blog">Dev Blogs</a></li>
<li class="last">
<a rel="nofollow" href="http://www.dreamincode.net/forums/forum/1-caffeine-lounge/">Lounge</a>
</li>
</ul>
<ul id="login-register">
<li id="login"><a rel="nofollow" href="http://www.dreamincode.net/forums/index.php?app=core&amp;module=global&amp;section=login">Login</a></li>
<li id="register"><a rel="nofollow" href="http://www.dreamincode.net/forums/index.php?app=core&amp;module=global&amp;section=register&amp;coppa_user=&amp;termsread=1&amp;coppa_pass=1&amp;agree_to_terms=1">Join!</a></li>
<li id="todaystopics"><a href="http://www.dreamincode.net/forums/index.php?app=core&amp;module=search&amp;do=active">Today's Topics</a></li>
</ul>
</div>
</div>
<script type="text/javascript" language="JavaScript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/google_service.js">
	</script>
<script type="text/javascript" language="JavaScript">
	  GS_googleAddAdSenseService("ca-pub-9822709549810875");
	  GS_googleEnableAllServices();
	</script>
<script type="text/javascript" language="JavaScript">
	  GA_googleUseIframeRendering(true);    // This indicates iframe rendering for all slots
	</script>
<div id="ad_header" style="margin: 5px auto; width: 728px; height: 90px; text-align: center;">
</div>
<div style=" background: #FFF; max-width: 1225px; margin: 0px auto; border-left: 1px solid #FFF;border-right: 1px solid #FFF;">
<div id="main_content">
<div id="content_hold" class="with_sidebar">
<div id="content_inner" class="content">
<div id="ipbwrapper">
<ul id="breadcrumb" itemprop="breadcrumb" class="left"><li class="first"><a href="http://www.dreamincode.net/forums/index">Dream.In.Code</a></li>
<li><span class="nav_sep">&gt;</span> <a href="http://www.dreamincode.net/forums/forum/78-programming-tutorials/" title="Return to Programming Tutorials">Programming Tutorials</a></li>
<li><span class="nav_sep">&gt;</span> <a href="http://www.dreamincode.net/forums/forum/48-c-tutorials/" title="Return to C++ Tutorials">C++ Tutorials</a></li>
</ul><br>
<div id="content" class="clear">
<a id="j_content"></a>
<script type="text/javascript">
//<![CDATA[
	ipb.topic.inSection = 'topicview';
	ipb.topic.topic_id  = 193519;
	ipb.topic.forum_id  = 48;
	ipb.topic.start_id  = 0;
	// Editor JS: Only needs to be done once per page
	ipb.editor_values.get('templates')['link'] = new Template("<label for='#{id}_url'>URL</label><input type='text' class='input_text' id='#{id}_url' value='http://' tabindex='10' /><label for='#{id}_urltext'>Link text</label><input type='text' class='input_text _select' id='#{id}_urltext' value='My link' tabindex='11' /><input type='submit' class='input_submit' value='Insert Link' tabindex='12' />");
ipb.editor_values.get('templates')['image'] = new Template("<label for='#{id}_img'>Image URL</label><input type='text' class='input_text' id='#{id}_img' value='http://' tabindex='10' /><input type='submit' class='input_submit' value='Insert Image' tabindex='11' />");
ipb.editor_values.get('templates')['email'] = new Template("<label for='#{id}_email'>Email Address</label><input type='text' class='input_text' id='#{id}_email' tabindex='10' /><label for='#{id}_emailtext'>Link text</label><input type='text' class='input_text _select' id='#{id}_emailtext' value='Email me' tabindex='11' /><input type='submit' class='input_submit' value='Insert Email' tabindex='12' />");
ipb.editor_values.get('templates')['media'] = new Template("<label for='#{id}_media'>Media URL</label><input type='text' class='input_text' id='#{id}_media' value='http://' tabindex='10' /><input type='submit' class='input_submit' value='Insert Media' tabindex='11' />");
ipb.editor_values.get('templates')['generic'] = new Template("<div class='rte_title'>#{title}</div><strong>Example</strong><pre>#{example}</pre><label for='#{id}_option' class='optional'>#{option_text}</label><input type='text' class='input_text optional' id='#{id}_option' tabindex='10' /><label for='#{id}_text'>#{value_text}</label><input type='text' class='input_text _select' id='#{id}_text' tabindex='11' /><input type='submit' class='input_submit' value='Add' tabindex='12' />");
ipb.editor_values.get('templates')['togglesource'] = new Template("<fieldset id='#{id}_ts_controls' class='submit' style='text-align: left'><input type='button' class='input_submit' value='Update' id='#{id}_ts_update' />&nbsp;&nbsp;&nbsp; <a href='#' id='#{id}_ts_cancel' class='cancel'>Cancel Source Edit</a></fieldset>");
	
ipb.editor_values.get('templates')['toolbar'] = new Template("<ul id='#{id}_toolbar_#{toolbarid}' class='toolbar' style='display: none'>#{content}</ul>");
ipb.editor_values.get('templates')['button'] = new Template("<li><span id='#{id}_cmd_custom_#{cmd}' class='rte_control rte_button specialitem' title='#{title}'><img src='http://cdn2.dreamincode.net/dreamincode/forums/public/style_images/master/rte_icons/#{img}' alt='Icon' /></span></li>");
ipb.editor_values.get('templates')['menu_item'] = new Template("<li id='#{id}_cmd_custom_#{cmd}' class='specialitem clickable'>#{title}</li>");
ipb.editor_values.get('templates')['togglesource'] = new Template("<fieldset id='#{id}_ts_controls' class='submit' style='text-align: left'><input type='button' class='input_submit' value='Update' id='#{id}_ts_update' />&nbsp;&nbsp;&nbsp; <a href='#' id='#{id}_ts_cancel' class='cancel'>Cancel Source Edit</a></fieldset>");
ipb.editor_values.get('templates')['emoticons_showall'] = new Template("<input class='input_submit emoticons' type='button' id='#{id}_all_emoticons' value='Show all emoticons' />");
ipb.editor_values.get('templates')['emoticon_wrapper'] = new Template("<h4><span>Emoticons</span></h4><div id='#{id}_emoticon_holder' class='emoticon_holder'></div>");

// Add smilies into the mix
ipb.editor_values.set( 'show_emoticon_link', false );

ipb.editor_values.set( 'bbcodes', $H({"snapback":{"id":"1","title":"Post Snap Back","desc":"This tag displays a little linked image which links back to a post - used when quoting posts from the board. Opens in same window by default.","tag":"snapback","useoption":"0","example":"[snapback]100[/snapback]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"topic":{"id":"5","title":"Topic Link","desc":"This tag provides an easy way to link to a topic","tag":"topic","useoption":"1","example":"[topic=1]Click me![/topic]","switch_option":"0","menu_option_text":"Enter the topic ID","menu_content_text":"Enter the title for this link","single_tag":"0","optional_option":"0","image":""},"post":{"id":"6","title":"Post Link","desc":"This tag provides an easy way to link to a post.","tag":"post","useoption":"1","example":"[post=1]Click me![/post]","switch_option":"0","menu_option_text":"Enter the Post ID","menu_content_text":"Enter the title for this link","single_tag":"0","optional_option":"0","image":""},"spoiler":{"id":"7","title":"Spoiler","desc":"Spoiler tag","tag":"spoiler","useoption":"0","example":"[spoiler]Some hidden text[/spoiler]","switch_option":"0","menu_option_text":"","menu_content_text":"Enter the text to be masked","single_tag":"0","optional_option":"0","image":""},"acronym":{"id":"8","title":"Acronym","desc":"Allows you to make an acronym that will display a description when moused over","tag":"acronym","useoption":"1","example":"[acronym='Laugh Out Loud']lol[/acronym]","switch_option":"0","menu_option_text":"Enter the description for this acronym (EG: Laugh Out Loud)","menu_content_text":"Enter the acronym (EG: lol)","single_tag":"0","optional_option":"0","image":""},"hr":{"id":"12","title":"Horizontal Rule","desc":"Adds a horizontal rule to separate text","tag":"hr","useoption":"0","example":"[hr]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"1","optional_option":"0","image":""},"php":{"id":"14","title":"PHP Code","desc":"Allows you to enter PHP code into a formatted/highlighted syntax box","tag":"php","useoption":"0","example":"[php]$variable = true;\n\nprint_r($variable);[/php]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"html":{"id":"15","title":"HTML Code","desc":"Allows you to enter formatted/syntax-highlighted HTML code","tag":"html","useoption":"0","example":"[html]<body>\n <div class='outer'>\n  <p>Hello World</p>\n </div>\n</body>[/html]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"sql":{"id":"16","title":"SQL Code","desc":"Allows you to enter formatted/syntax-highlighted SQL code","tag":"sql","useoption":"0","example":"[sql]SELECT p.*, t.* FROM posts p LEFT JOIN topics t ON t.tid=p.topic_id WHERE t.tid=7[/sql]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"xml":{"id":"17","title":"XML Code","desc":"Allows you to enter formatted/syntax-highlighted XML code","tag":"xml","useoption":"0","example":"[xml]<outer>\n <inner>\n  <tag param='1'>Test</tag>\n </inner>\n</outer>[/xml]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"member":{"id":"31","title":"Member","desc":"Given a member name, a link is automatically generated to the member's profile","tag":"member","useoption":"1","example":"[member=skyhawk133] runs this site.","switch_option":"0","menu_option_text":"Input Username of Member","menu_content_text":"","single_tag":"1","optional_option":"0","image":"memberbbcode.png"},"extract":{"id":"33","title":"Extract Blog Entry","desc":"This will allow users to define an extract for an entry. Only this piece of the entry will be displayed on the main blog page and will show up in the RSS feed.","tag":"extract","useoption":"0","example":"[extract]This is an example![/extract]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"blog":{"id":"34","title":"Blog Link","desc":"This tag provides an easy way to link to a blog.","tag":"blog","useoption":"1","example":"[blog=100]Click me![/blog]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"entry":{"id":"35","title":"Blog Entry Link","desc":"This tag provides an easy way to link to a blog entry.","tag":"entry","useoption":"1","example":"[entry=100]Click me![/entry]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"twitter":{"id":"36","title":"Twitter","desc":"A tag to link to a user's twitter account","tag":"twitter","useoption":"0","example":"[twitter]userName[/twitter]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":"twitter.png"},"inline":{"id":"37","title":"Inline Code","desc":"Formats code inline instead of in a seperate code box. ","tag":"inline","useoption":"0","example":"[inline]style=\"font-size: 12px;\"[/inline]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"il":{"id":"38","title":"Abbreviated Inline (IL)","desc":"Abbreviated version of the [inline] tag. ","tag":"il","useoption":"0","example":"[il]Code Here[/il]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":"il2.png"},"code":{"id":"41","title":"Code","desc":"Allows you to enter general code","tag":"code","useoption":"1","example":"[code]$text = 'Some long code here';[/code]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"1","image":""}}) );
	ipb.vars['emoticon_url'] = "http://cdn2.dreamincode.net/dreamincode/forums/public/style_emoticons/default";
	//Search Setup
	ipb.vars['search_type']			= 'forum';
	ipb.vars['search_type_id']		= 48;
	ipb.vars['search_type_2']		= 'topic';
	ipb.vars['search_type_id_2']	= 193519;
//]]>
</script>
<div class="topic_controls">
<span class="pagination no_pages left">Page 1 of 1</span>
</div>
<div class="topic hfeed">
<h2 class="maintitle">
<span class="main_topic_title">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/" style="text-decoration: none;">Win32 WebCam Program</a>
<span class="desc main_topic_desc">Displays a Webcam Picture, Saves it as a .bmp file</span>
</span>
<span class="rating">Rate Topic:
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=extras&amp;section=rating&amp;t=193519&amp;rating=1" id="topic_rate_1" title="Rate topic 1 star"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/bullet_star.png" alt="*" class="rate_img"></a><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=extras&amp;section=rating&amp;t=193519&amp;rating=2" id="topic_rate_2" title="Rate topic 2 stars"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/bullet_star.png" alt="*" class="rate_img"></a><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=extras&amp;section=rating&amp;t=193519&amp;rating=3" id="topic_rate_3" title="Rate topic 3 stars"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/bullet_star.png" alt="*" class="rate_img"></a><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=extras&amp;section=rating&amp;t=193519&amp;rating=4" id="topic_rate_4" title="Rate topic 4 stars"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/bullet_star.png" alt="*" class="rate_img"></a><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=extras&amp;section=rating&amp;t=193519&amp;rating=5" id="topic_rate_5" title="Rate topic 5 stars"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/bullet_star.png" alt="*" class="rate_img"></a>
<span id="rating_text">
<span id="rating_hits">3</span> Votes
</span>
<script type="text/javascript">
				//<![CDATA[
					rating = new ipb.rating( 'topic_rate_', { 
										url: 'http://www.dreamincode.net/forums/index.php?app=forums&module=ajax&section=topics&do=rateTopic&t=193519&md5check=' + ipb.vars['secure_hash'],
										cur_rating: 5,
										rated: 0,
										allow_rate: 0,
										multi_rate: 1,
										show_rate_text: true
									  } );
				//]]>
				</script>
<br>
</span>
</h2>
<div class="post_block hentry clear  with_rep" id="post_id_1132474">
<a id="entry1132474"></a>
<div class="post_wrap">
<h3>
<span class="post_id">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__findpost__p__1132474" rel="bookmark" title="Link to post #1">#1</a>
</span>
<span class="author vcard">
<a class="url fn" href="http://www.dreamincode.net/forums/user/358927-snoopy11/">snoopy11</a>
&nbsp;<a href="http://www.dreamincode.net/forums/user/358927-snoopy11/page__f__48" class="__user __id358927 __fid48" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_popup.png" alt="Icon"></a>
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_off.png" alt="User is offline" title="User is offline">
</span>
</h3>
<div class="author_info">
<ul class="user_details">
<li class="avatar"><a href="http://www.dreamincode.net/forums/user/358927-snoopy11/" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/av-358927.jpg" alt="" width="52" height="64"></a></li>
<li class="title">D.I.C Regular</li>
<li class="group_icon">
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/author_group.gif" alt="member icon">
</li>
</ul>
<br>
<div class="reputation positive">
<span class="number">Reputation: 131</span>
</div>
<div style="margin: 0 auto;">
<ul class="user_controls clear">
<li><a href="http://www.dreamincode.net/forums/index.php?app=blog&amp;module=display&amp;section=blog&amp;mid=358927" title="View blog"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/book_open.png" alt="View blog"></a></li>
</ul>
</div>
<ul class="user_fields">
<li>
<span class="ft">Posts:</span>
<span class="fc">473</span>
</li>
<li>
<span class="ft">Joined:</span>
<span class="fc">20-March 10</span>
</li>
</ul>
</div>
<div class="post_body">
<p class="posted_info">
Posted <abbr class="published" title="2010-10-05T04:11:04+00:00">04 October 2010 - 09:11 PM</abbr>
</p>
<p class="rep_highlight"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/star_big.png" alt="*"><br>POPULAR</p>
<div class="post entry-content">
<span style="font-size: 21px;"><strong class="bbc">WebCam Tutorial.</strong></span><br>
<br>
This WebCam Tutorial will guide you through connecting a webcam in 
Microsoft Windows and grabbing a frame from the camera so we can later<br>
save it to a bitmap file called "Frame.bmp".<br>
First of all this is a c++ win32 Tutorial so create an empty Win32 application.<br>
<br>
<span style="font-size: 15px;"><strong class="bbc">1. Setting up some defines.</strong></span><br>
<br>
First of all we need to set up some defines that we need to connect to a
 webcam. If you are using Microsoft&#8217;s Visual Studio Pro edition you wont
 need them as they are included in Microsoft&#8217;s version of vfw.h, if you 
are<br>
using something else like Code::Blocks as I am then you will need them.<br>
I recommend storing them in a header but I will put them in the main .cpp.<br>
They are basically just values.<br>
<div class="syntaxhighlighter  " id="highlighter_224580"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_224580_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_224580" menu="false" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#define WM_CAP_START&nbsp; 0x0400</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="preprocessor">#define WM_CAP_DRIVER_CONNECT&nbsp; (WM_CAP_START + 10)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="preprocessor">#define WM_CAP_DRIVER_DISCONNECT&nbsp; (WM_CAP_START + 11)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="preprocessor">#define WM_CAP_EDIT_COPY (WM_CAP_START + 30)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="preprocessor">#define WM_CAP_GRAB_FRAME (WM_CAP_START + 60)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="preprocessor">#define WM_CAP_SET_SCALE (WM_CAP_START + 53)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="preprocessor">#define WM_CAP_SET_PREVIEWRATE (WM_CAP_START + 52)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="preprocessor">#define WM_CAP_SET_PREVIEW (WM_CAP_START + 50)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="preprocessor">#define WM_CAP_DLG_VIDEOSOURCE&nbsp; (WM_CAP_START + 42)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="preprocessor">#define WM_CAP_STOP (WM_CAP_START+ 68)</code></td></tr></tbody></table></div></div></div><br>
<br>
<span style="font-size: 15px;"><strong class="bbc">2. Include Files.</strong></span><br>
<br>
We need to include two header files the first is windows.h<br>
which is just the standard windows header. The other is vfw.h <br>
which stands for video for windows and is where the webcam stuff is.<br>
You will need to link to vfw32 Library in your projects linker settings.<br>
<br>
For Code::Blocks this is done through Project -&gt; Build Options -&gt;<br>
Linker Settings and click the add button and type -&gt; vfw32.<br>
At the same time you might as well add gdi32 as well.<br>
<br>
For Microsofts Visual C++ Pro or Express Edition<br>
its Project -&gt; properties or Alt+F7.<br>
Configuration Properties -&gt; Linker -&gt; Input -&gt; Additional Dependencies<br>
type in Vfw32.lib; and check to make sure gdi32.lib; is also there<br>
in the dependencies.<br>
<br>
If you are using the express Edition you will have to download the <br>
windows sdk. Found here at -&gt;<br>
<br>
<a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=c17ba869-9671-4330-a63e-1fd44e0e2505&amp;displaylang=en" class="bbc_url" title="External link" rel="external">Link to SDK</a><br>
<br>
It requires Windows XP SP3 and above.<br>
<br>
Click the link to download it.<br>
And open up windows explorer and go to -&gt;<br>
Program Files\Microsoft SDKs\Windows\v7.0A<br>
<br>
there you should see a bin folder, a lib folder and an include folder.<br>
Open the include folder and select Edit -&gt; Select All and then Edit -&gt; Copy.<br>
<br>
Then go to your compilers include folder typically Program Files -&gt;<br>
Microsoft Visual Studio 10.0-&gt; VC<br>
there you should see another include folder open it and paste what you have copied into it.<br>
This will copy the Header required for this program and all other headers <br>
which you might like to have into it.<br>
<br>
Go back to Program Files\Microsoft SDKs\Windows\v7.0A<br>
and open the lib folder, select Edit -&gt; Select All and then Edit -&gt; Copy.<br>
<br>
Go to Program Files\ Microsoft Visual Studio 10.0\ VC<br>
and open the lib folder and paste what you have copied into it.<br>
<br>
This will copy a host of very good libraries one of which is called<br>
Vfw32.lib. Which we will use in our Webcam Program.<br>
<br>
If you are using Microsoft Visual C++ Pro or Express Edition<br>
there is one more thing you will have to do because this code is not<br>
a unicode build.<br>
<br>
Go to Project -&gt; Properties-&gt; Configuration Properties -&gt; General <br>
click on Character Set and change it to use Multi-Byte Character Set.<br>
<br>
<br>
<div class="syntaxhighlighter  " id="highlighter_423518"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_423518_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_423518" menu="false" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="preprocessor">#include &lt;windows.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="preprocessor">#include &lt;vfw.h&gt;</code></td></tr></tbody></table></div></div></div><br>
<br>
<br>
<br>
<br>
<span style="font-size: 15px;"><strong class="bbc">3. Procedures.</strong></span><br>
<br>
We will use 3 procedures the first is WindowProc.<br>
The second is CreateBitmapInfoStruct which is a PBITMAPINFO <br>
structure which contains information on color and dimension in a windows based DIB.<br>
The third and last procedure is CreateBMPFile which creates and saves<br>
the bitmap as a .bmp file.<br>
<br>
<div class="syntaxhighlighter  " id="highlighter_407046"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_407046_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_407046" menu="false" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="color1 bold">LRESULT</code> <code class="plain">CALLBACK WindowProc (</code><code class="color1 bold">HWND</code><code class="plain">, </code><code class="color1 bold">UINT</code><code class="plain">, </code><code class="color1 bold">WPARAM</code><code class="plain">, </code><code class="color1 bold">LPARAM</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">PBITMAPINFO CreateBitmapInfoStruct(</code><code class="color1 bold">HWND</code> <code class="plain">hwnd, </code><code class="color1 bold">HBITMAP</code> <code class="plain">hBmp);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="keyword bold">void</code> <code class="plain">CreateBMPFile(</code><code class="color1 bold">HWND</code> <code class="plain">hwnd, </code><code class="color1 bold">LPTSTR</code> <code class="plain">pszFile, PBITMAPINFO pbi, </code><code class="color1 bold">HBITMAP</code> <code class="plain">hBMP, </code><code class="color1 bold">HDC</code> <code class="plain">hDC);</code></td></tr></tbody></table></div></div></div><br>
<br>
<br>
<span style="font-size: 15px;"><strong class="bbc">4. Setting up the window.</strong></span><br>
<br>
Next we need to setup some variables and a window itself.<br>
<br>
<div class="syntaxhighlighter  " id="highlighter_177029"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_177029_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_177029" menu="false" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="color1 bold">char</code> <code class="plain">szAppName [] = TEXT(</code><code class="string">"WebCam"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="color1 bold">HWND</code> <code class="plain">camhwnd;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="color1 bold">HDC</code> <code class="plain">hdc ;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="color1 bold">HDC</code> <code class="plain">hdcMem;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="plain">PAINTSTRUCT ps;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="color1 bold">HBITMAP</code> <code class="plain">hbm;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="plain">RECT rc;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="comments">//WinMain -- Main Window</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">WINAPI WinMain ( </code><code class="color1 bold">HINSTANCE</code> <code class="plain">hInstance, </code><code class="color1 bold">HINSTANCE</code> <code class="plain">hPrevInstance,</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="color1 bold">LPSTR</code> <code class="plain">lpCmdLine, </code><code class="color1 bold">int</code> <code class="plain">nCmdShow )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="color1 bold">HWND</code> <code class="plain">hwnd;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="plain">MSG msg;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="plain">WNDCLASS wc;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="plain">wc.style = CS_HREDRAW|CS_VREDRAW;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="plain">wc.lpfnWndProc = WindowProc;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="plain">wc.cbClsExtra = 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="plain">wc.cbWndExtra = 0;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="plain">wc.hInstance = hInstance;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="plain">wc.hIcon = LoadIcon(GetModuleHandle(NULL), IDI_APPLICATION);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="plain">wc.hCursor = LoadCursor (NULL, IDC_ARROW);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="plain">wc.hbrBackground = (</code><code class="color1 bold">HBRUSH</code><code class="plain">) (COLOR_WINDOW+1);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="plain">wc.lpszMenuName = NULL;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="plain">wc.lpszClassName = szAppName;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="plain">RegisterClass (&amp;wc);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="comments">// Create the window</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="plain">hwnd
 = CreateWindow 
(szAppName,szAppName,WS_OVERLAPPED|WS_CAPTION|WS_SYSMENU|WS_MINIMIZEBOX,CW_USEDEFAULT,CW_USEDEFAULT,300,600,0,0,hInstance,0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="plain">ShowWindow (hwnd,SW_SHOW);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="plain">UpdateWindow (hwnd);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="keyword bold">while</code> <code class="plain">(GetMessage(&amp;msg,0,0,0))</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content"><code class="keyword bold">if</code><code class="plain">(!IsDialogMessage(hwnd, &amp;msg))</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="plain">TranslateMessage (&amp;msg);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content"><code class="plain">DispatchMessage (&amp;msg);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="keyword bold">return</code> <code class="plain">msg.wParam;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div><br>
<br>
<span style="font-size: 15px;"><strong class="bbc">5. WindowProc.</strong></span><br>
<br>
First of all we need to set up three buttons.<br>
These are<br>
1. A start camera button.<br>
2. A stop camera button.<br>
3. A button to grab a frame from the camera.<br>
<br>
Secondly we need to set up a Camera window<br>
this is called camhwnd and is created by using<br>
the capCreateCaptureWindow command this must include<br>
the Window style WS_CHILD.<br>
<br>
Third we need to pick a webcam from the Video source Dialog <br>
WM_CAP_DLG_VIDEOSOURCE.<br>
We do this by sending a message to our camera window camhwnd.<br>
<br>
SendMessage(camhwnd,WM_CAP_DRIVER_CONNECT,0,0);<br>
SendMessage(camhwnd,WM_CAP_DLG_VIDEOSOURCE,0,0);<br>
<br>
<br>
There is another way to do this by enumerating all webcam drivers<br>
on the system but for simplicity I wont be doing this in this tutorial<br>
I may write another tutorial on how to do this at a later date.<br>
<br>
Fourth come the Window Message Commands<br>
<br>
1. Case 1<br>
This connects and shows our webcam picture.<br>
WM_CAP_SET_SCALE is set to true to enable the webcam <br>
picture to be resized to the dimensions of our camera window.<br>
WM_CAP_SET_PREVIEWRATE is set to 66 frames per second.<br>
To provide a reasonable moving picture without too much demand on resources.<br>
WM_CAP_SET_PREVIEW is set to true so a picture will be drawn on the camera window camhwnd.<br>
<br>
2. Case 2<br>
Calls WM_CAP_DRIVER_DISCONNECT to amazingly enough <br>
disconnect the webcam.<br>
<br>
3. Case 3<br>
This grabs the frame and saves it to a .bmp file called "Frame.bmp"<br>
WM_CAP_GRAB_FRAME does the frame grabbing this freezes the camera output so we will need to restart it later on.<br>
WM_CAP_EDIT_COPY copies our grabbed frame to the clipboard.<br>
Then we copy the clipboard image data to a HBITMAP object called<br>
&#8216;hbm&#8217;.<br>
We then create and save the bitmap file itself using &#8216;hbm&#8217; and the 
function call CreateBMPFile(hwnd, "Frame.bmp", pbi, hbm, hdcMem);<br>
<br>
.<br>
<br>
4. Case WM_DESTROY<br>
Its important we disconnect the webcam if the user closes the window.<br>
<br>
<div class="syntaxhighlighter  " id="highlighter_926756"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_926756_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_926756" menu="false" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>001</code></td><td class="content"><code class="comments">//Main Window Procedure WindowProc</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>002</code></td><td class="content"><code class="color1 bold">LRESULT</code> <code class="plain">CALLBACK WindowProc(</code><code class="color1 bold">HWND</code> <code class="plain">hwnd, </code><code class="color1 bold">UINT</code> <code class="plain">message, </code><code class="color1 bold">WPARAM</code> <code class="plain">wParam, </code><code class="color1 bold">LPARAM</code> <code class="plain">lParam)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>003</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>004</code></td><td class="content"><code class="color1 bold">HINSTANCE</code> <code class="plain">hInstance = GetModuleHandle(NULL);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>005</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>006</code></td><td class="content"><code class="comments">//some buttons</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>007</code></td><td class="content"><code class="color1 bold">HWND</code> <code class="plain">hButtStartCam;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>008</code></td><td class="content"><code class="color1 bold">HWND</code> <code class="plain">hButtStopCam;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>009</code></td><td class="content"><code class="color1 bold">HWND</code> <code class="plain">hButtGrabFrame;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>010</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>011</code></td><td class="content"><code class="keyword bold">switch</code> <code class="plain">(message)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* handle the messages */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>012</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>013</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>014</code></td><td class="content"><code class="keyword bold">case</code> <code class="plain">WM_CTLCOLORSTATIC:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>015</code></td><td class="content"><code class="plain">SetBkMode(hdc,TRANSPARENT);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>016</code></td><td class="content"><code class="keyword bold">return</code> <code class="plain">(</code><code class="color1 bold">LRESULT</code><code class="plain">)CreateSolidBrush(0xFFFFFF);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>017</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>018</code></td><td class="content"><code class="keyword bold">case</code> <code class="plain">WM_CREATE:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>019</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>020</code></td><td class="content"><code class="plain">hButtStartCam = CreateWindowEx(0,</code><code class="string">"BUTTON"</code><code class="plain">,</code><code class="string">"Start Camera"</code><code class="plain">,WS_CHILD | WS_VISIBLE,</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>021</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">0,0,100,20,hwnd,(</code><code class="color1 bold">HMENU</code><code class="plain">)1,hInstance, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>022</code></td><td class="content"><code class="plain">hButtStopCam = CreateWindowEx(0,</code><code class="string">"BUTTON"</code><code class="plain">,</code><code class="string">"Stop Camera"</code><code class="plain">,WS_CHILD | WS_VISIBLE,</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>023</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">0,25,100,20,hwnd,(</code><code class="color1 bold">HMENU</code><code class="plain">)2,hInstance, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>024</code></td><td class="content"><code class="plain">hButtGrabFrame = CreateWindowEx(0,</code><code class="string">"BUTTON"</code><code class="plain">,</code><code class="string">"Grab Frame"</code><code class="plain">,WS_CHILD | WS_VISIBLE,</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>025</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">0,50,100,20,hwnd,(</code><code class="color1 bold">HMENU</code><code class="plain">)3,hInstance, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>026</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>027</code></td><td class="content"><code class="plain">camhwnd = capCreateCaptureWindow (</code><code class="string">"camera window"</code><code class="plain">, WS_CHILD , 0, 100, 300, 300, hwnd, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>028</code></td><td class="content"><code class="plain">SendMessage(camhwnd,WM_CAP_DRIVER_CONNECT,0,0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>029</code></td><td class="content"><code class="plain">SendMessage(camhwnd,WM_CAP_DLG_VIDEOSOURCE,0,0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>030</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>031</code></td><td class="content"><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>032</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>033</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>034</code></td><td class="content"><code class="keyword bold">case</code> <code class="plain">WM_COMMAND:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>035</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>036</code></td><td class="content"><code class="keyword bold">switch</code><code class="plain">(LOWORD(wParam))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>037</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>038</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>039</code></td><td class="content"><code class="keyword bold">case</code> <code class="plain">1:</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>040</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>041</code></td><td class="content"><code class="plain">ShowWindow(camhwnd,SW_SHOW);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>042</code></td><td class="content"><code class="plain">SendMessage(camhwnd,WM_CAP_DRIVER_CONNECT,0,0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>043</code></td><td class="content"><code class="plain">SendMessage(camhwnd, WM_CAP_SET_SCALE, </code><code class="keyword bold">true</code> <code class="plain">, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>044</code></td><td class="content"><code class="plain">SendMessage(camhwnd, WM_CAP_SET_PREVIEWRATE, 66, 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>045</code></td><td class="content"><code class="plain">SendMessage(camhwnd, WM_CAP_SET_PREVIEW, </code><code class="keyword bold">true</code> <code class="plain">, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>046</code></td><td class="content"><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>047</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>048</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>049</code></td><td class="content"><code class="keyword bold">case</code> <code class="plain">2:</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>050</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>051</code></td><td class="content"><code class="plain">ShowWindow(camhwnd,SW_HIDE);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>052</code></td><td class="content"><code class="plain">SendMessage(camhwnd, WM_CAP_DRIVER_DISCONNECT, 0, 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>053</code></td><td class="content"><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>054</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>055</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>056</code></td><td class="content"><code class="keyword bold">case</code> <code class="plain">3:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>057</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>058</code></td><td class="content"><code class="comments">//Grab a Frame</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>059</code></td><td class="content"><code class="plain">SendMessage(camhwnd, WM_CAP_GRAB_FRAME, 0, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>060</code></td><td class="content"><code class="comments">//Copy the frame we have just grabbed to the clipboard</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>061</code></td><td class="content"><code class="plain">SendMessage(camhwnd, WM_CAP_EDIT_COPY,0,0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>062</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>063</code></td><td class="content"><code class="comments">//Copy the clipboard image data to a HBITMAP object called hbm</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>064</code></td><td class="content"><code class="plain">hdc = BeginPaint(camhwnd, &amp;ps);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>065</code></td><td class="content"><code class="plain">hdcMem = CreateCompatibleDC(hdc);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>066</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(hdcMem != NULL)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>067</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>068</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(OpenClipboard(camhwnd))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>069</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>070</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hbm = (</code><code class="color1 bold">HBITMAP</code><code class="plain">) GetClipboardData(CF_BITMAP);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>071</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SelectObject(hdcMem, hbm);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>072</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">GetClientRect(camhwnd, &amp;rc);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>073</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">CloseClipboard();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>074</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>075</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>076</code></td><td class="content"><code class="comments">//Save hbm to a .bmp file called Frame.bmp</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>077</code></td><td class="content"><code class="plain">PBITMAPINFO pbi = CreateBitmapInfoStruct(hwnd, hbm);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>078</code></td><td class="content"><code class="plain">CreateBMPFile(hwnd, </code><code class="string">"Frame.bmp"</code><code class="plain">, pbi, hbm, hdcMem);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>079</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>080</code></td><td class="content"><code class="plain">SendMessage(camhwnd,WM_CAP_DRIVER_CONNECT,0,0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>081</code></td><td class="content"><code class="plain">SendMessage(camhwnd, WM_CAP_SET_SCALE, </code><code class="keyword bold">true</code> <code class="plain">, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>082</code></td><td class="content"><code class="plain">SendMessage(camhwnd, WM_CAP_SET_PREVIEWRATE, 66, 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>083</code></td><td class="content"><code class="plain">SendMessage(camhwnd, WM_CAP_SET_PREVIEW, </code><code class="keyword bold">true</code> <code class="plain">, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>084</code></td><td class="content"><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>085</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>086</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>087</code></td><td class="content"><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>088</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>089</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>090</code></td><td class="content"><code class="keyword bold">case</code> <code class="plain">WM_DESTROY:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>091</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>092</code></td><td class="content"><code class="plain">SendMessage(camhwnd, WM_CAP_DRIVER_DISCONNECT, 0, 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>093</code></td><td class="content"><code class="plain">PostQuitMessage(0);&nbsp;&nbsp; </code><code class="comments">/* send a WM_QUIT to the message queue */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>094</code></td><td class="content"><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>095</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>096</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>097</code></td><td class="content"><code class="keyword bold">default</code><code class="plain">:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* for messages that we don't deal with */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>098</code></td><td class="content"><code class="keyword bold">return</code> <code class="plain">DefWindowProc(hwnd, message, wParam, lParam);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>099</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>100</code></td><td class="content"><code class="keyword bold">return</code> <code class="plain">0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>101</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div><br>
<br>
<span style="font-size: 15px;"><strong class="bbc">6. Procedures to Create and Save a Bitmap.</strong></span><br>
<br>
First up is CreateBitmapInfoStruct<br>
which creates a PBITMAPINFO structure it takes two<br>
arguments HWND and an HBITMAP object.<br>
<br>
A DIB consists of two distinct parts: a BITMAPINFO structure describing 
the dimensions and colors of the bitmap, and an array of bytes defining 
the pixels of the bitmap. The bits in the array are packed together, but
 each scan line must be padded with zeroes to end on a LONG data-type 
boundary. If the height of the bitmap is positive, the bitmap is a 
bottom-up DIB and its origin is the lower-left corner. If the height is 
negative, the bitmap is a top-down DIB and its origin is the upper left 
corner.<br>
<br>
A bitmap is packed when the bitmap array immediately follows the 
BITMAPINFO header. Packed bitmaps are referenced by a single pointer. 
For packed bitmaps, the biClrUsed member must be set to an even number 
when using the BI_RGB mode . BI_RGB means that the bitmap is 
uncompressed.<br>
<br>
Secondly we use CreateBMPFile to save the bitmap<br>
it takes 5 arguments the hwnd which owns the bitmap, the filename<br>
in this case "Frame.bmp" a PBITMAPINFO structure which we have just went
 over, a HBITMAP object and a HDC, handle to device context.<br>
First of all is pbih which is a PBITMAPINFOHEADER<br>
this structure contains information about the dimensions and color format of a DIB. <br>
lpBits contains the size, in bytes, of the image and we allocate some 
memory for it. Next up we use GetDIBits to retrieve the color table and 
the bits from the DIB. This function retrieves the bits of the specified
 compatible bitmap and copies them into a buffer as a DIB using the 
specified format.<br>
In this case DIB_RGB_COLORS.<br>
<br>
Next we create the file using CreateFile the CREATE_ALWAYS<br>
parameter Creates a new file, always.<br>
<br>
If the specified file exists and is writable, the function overwrites 
the file, the function succeeds, and last-error code is set to 
ERROR_ALREADY_EXISTS.<br>
<br>
Next up is the BITMAPFILEHEADER hdr.<br>
It is important to note that hdr.bfType has to have the &#8216;BM&#8217; designator 
in it which is made up of 0x4d42 which is B = 0x42 and M = 0x4d.<br>
<br>
The bfSize member specifies the size, in bytes, of the bitmap file.<br>
<br>
hdr.bfReserved1and hdr.bfReserved2 must always be set to zero.<br>
<br>
BfOffBits Specifies the offset, in bytes, from the BITMAPFILEHEADER structure to the bitmap bits.<br>
<br>
Next we copy the BITMAPFILEHEADER into the .BMP file<br>
with WriteFile<br>
Next we copy the BITMAPINFOHEADER and RGBQUAD array into the file.<br>
With WriteFile<br>
<br>
Next we copy the array of color indices into the .BMP file<br>
with WriteFile<br>
<br>
Last of all we close the .BMP file with CloseHandle<br>
and free the memory we allocated for lpbits<br>
<div class="syntaxhighlighter  " id="highlighter_49717"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_49717_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_49717" menu="false" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>001</code></td><td class="content"><code class="keyword bold">void</code> <code class="plain">CreateBMPFile(</code><code class="color1 bold">HWND</code> <code class="plain">hwnd, </code><code class="color1 bold">LPTSTR</code> <code class="plain">pszFile, PBITMAPINFO pbi, </code><code class="color1 bold">HBITMAP</code> <code class="plain">hBMP, </code><code class="color1 bold">HDC</code> <code class="plain">hDC)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>002</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>003</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">HANDLE</code> <code class="plain">hf;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// file handle</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>004</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">BITMAPFILEHEADER hdr;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// bitmap file-header</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>005</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">PBITMAPINFOHEADER pbih;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// bitmap info-header</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>006</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">LPBYTE</code> <code class="plain">lpBits;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// memory pointer</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>007</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">DWORD</code> <code class="plain">dwTotal;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// total count of bytes</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>008</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">DWORD</code> <code class="plain">cb;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// incremental count of bytes</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>009</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">BYTE</code> <code class="plain">*hp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// byte pointer</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>010</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">DWORD</code> <code class="plain">dwTmp;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>011</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>012</code></td><td class="content"><code class="plain">pbih = (PBITMAPINFOHEADER) pbi;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>013</code></td><td class="content"><code class="plain">lpBits = (</code><code class="color1 bold">LPBYTE</code><code class="plain">) GlobalAlloc(GMEM_FIXED, pbih-&gt;biSizeImage);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>014</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>015</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(!lpBits)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>016</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>017</code></td><td class="content"><code class="plain">MessageBox(hwnd,</code><code class="string">"GlobalAlloc"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">, MB_OK );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>018</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>019</code></td><td class="content"><code class="comments">// Retrieve the color table (RGBQUAD array) and the bits</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>020</code></td><td class="content"><code class="comments">// (array of palette indices) from the DIB.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>021</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(!GetDIBits(hDC, hBMP, 0, (</code><code class="color1 bold">WORD</code><code class="plain">) pbih-&gt;biHeight, lpBits, pbi,DIB_RGB_COLORS))</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>022</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>023</code></td><td class="content"><code class="plain">MessageBox(hwnd,</code><code class="string">"GetDIBits"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">,MB_OK );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>024</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>025</code></td><td class="content"><code class="comments">// Create the .BMP file.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>026</code></td><td class="content"><code class="plain">hf = CreateFile(pszFile,GENERIC_READ | GENERIC_WRITE,(</code><code class="color1 bold">DWORD</code><code class="plain">) 0,NULL,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,(</code><code class="color1 bold">HANDLE</code><code class="plain">) NULL);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>027</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(hf == INVALID_HANDLE_VALUE)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>028</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>029</code></td><td class="content"><code class="plain">MessageBox( hwnd,</code><code class="string">"CreateFile"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">, MB_OK);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>030</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>031</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>032</code></td><td class="content"><code class="plain">hdr.bfType = 0x4d42;&nbsp; </code><code class="comments">// File type designator "BM" 0x42 = "B" 0x4d = "M"</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>033</code></td><td class="content"><code class="comments">// Compute the size of the entire file.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>034</code></td><td class="content"><code class="plain">hdr.bfSize = (</code><code class="color1 bold">DWORD</code><code class="plain">) (</code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPFILEHEADER) + pbih-&gt;biSize + pbih-&gt;biClrUsed * </code><code class="keyword bold">sizeof</code><code class="plain">(RGBQUAD) + pbih-&gt;biSizeImage);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>035</code></td><td class="content"><code class="plain">hdr.bfReserved1 = 0;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>036</code></td><td class="content"><code class="plain">hdr.bfReserved2 = 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>037</code></td><td class="content"><code class="comments">// Compute the offset to the array of color indices.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>038</code></td><td class="content"><code class="plain">hdr.bfOffBits = (</code><code class="color1 bold">DWORD</code><code class="plain">) </code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPFILEHEADER) + pbih-&gt;biSize + pbih-&gt;biClrUsed * </code><code class="keyword bold">sizeof</code> <code class="plain">(RGBQUAD);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>039</code></td><td class="content"><code class="comments">// Copy the BITMAPFILEHEADER into the .BMP file.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>040</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(!WriteFile(hf, (</code><code class="color1 bold">LPVOID</code><code class="plain">) &amp;hdr, </code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPFILEHEADER), (</code><code class="color1 bold">LPDWORD</code><code class="plain">) &amp;dwTmp,&nbsp; NULL) )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>041</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>042</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="plain">MessageBox(hwnd,</code><code class="string">"WriteFileHeader"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">,MB_OK );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>043</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>044</code></td><td class="content"><code class="comments">// Copy the BITMAPINFOHEADER and RGBQUAD array into the file.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>045</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(!WriteFile(hf, (</code><code class="color1 bold">LPVOID</code><code class="plain">) pbih, </code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPINFOHEADER) + pbih-&gt;biClrUsed * </code><code class="keyword bold">sizeof</code> <code class="plain">(RGBQUAD), (</code><code class="color1 bold">LPDWORD</code><code class="plain">) &amp;dwTmp, NULL))</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>046</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>047</code></td><td class="content"><code class="plain">MessageBox(hwnd,</code><code class="string">"WriteInfoHeader"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">,MB_OK );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>048</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>049</code></td><td class="content"><code class="comments">// Copy the array of color indices into the .BMP file.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>050</code></td><td class="content"><code class="plain">dwTotal = cb = pbih-&gt;biSizeImage;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>051</code></td><td class="content"><code class="plain">hp = lpBits;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>052</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(!WriteFile(hf, (</code><code class="color1 bold">LPSTR</code><code class="plain">) hp, (</code><code class="color1 bold">int</code><code class="plain">) cb, (</code><code class="color1 bold">LPDWORD</code><code class="plain">) &amp;dwTmp,NULL))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>053</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>054</code></td><td class="content"><code class="plain">MessageBox(hwnd,</code><code class="string">"WriteFile"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">,MB_OK );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>055</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>056</code></td><td class="content"><code class="comments">// Close the .BMP file.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>057</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(!CloseHandle(hf))</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>058</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>059</code></td><td class="content"><code class="plain">MessageBox(hwnd,</code><code class="string">"CloseHandle"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">,MB_OK );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>060</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>061</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>062</code></td><td class="content"><code class="comments">// Free memory.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>063</code></td><td class="content"><code class="plain">GlobalFree((</code><code class="color1 bold">HGLOBAL</code><code class="plain">)lpBits);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>064</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>065</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>066</code></td><td class="content"><code class="plain">PBITMAPINFO CreateBitmapInfoStruct(</code><code class="color1 bold">HWND</code> <code class="plain">hwnd, </code><code class="color1 bold">HBITMAP</code> <code class="plain">hBmp)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>067</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>068</code></td><td class="content"><code class="plain">BITMAP bmp;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>069</code></td><td class="content"><code class="plain">PBITMAPINFO pbmi;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>070</code></td><td class="content"><code class="color1 bold">WORD</code> <code class="plain">cClrBits;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>071</code></td><td class="content"><code class="comments">// Retrieve the bitmap color format, width, and height.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>072</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(!GetObject(hBmp, </code><code class="keyword bold">sizeof</code><code class="plain">(BITMAP), (</code><code class="color1 bold">LPSTR</code><code class="plain">)&amp;bmp))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>073</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>074</code></td><td class="content"><code class="plain">MessageBox(hwnd,</code><code class="string">"GetObject"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">,MB_OK );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>075</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>076</code></td><td class="content"><code class="comments">// Convert the color format to a count of bits.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>077</code></td><td class="content"><code class="plain">cClrBits = (</code><code class="color1 bold">WORD</code><code class="plain">)(bmp.bmPlanes * bmp.bmBitsPixel);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>078</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(cClrBits == 1)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>079</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="plain">cClrBits = 1;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>080</code></td><td class="content"><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">(cClrBits &lt;= 4)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>081</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="plain">cClrBits = 4;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>082</code></td><td class="content"><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">(cClrBits &lt;= 8)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>083</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="plain">cClrBits = 8;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>084</code></td><td class="content"><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">(cClrBits &lt;= 16)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>085</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="plain">cClrBits = 16;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>086</code></td><td class="content"><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">(cClrBits &lt;= 24)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>087</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="plain">cClrBits = 24;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>088</code></td><td class="content"><code class="keyword bold">else</code> <code class="plain">cClrBits = 32;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>089</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>090</code></td><td class="content"><code class="comments">// Allocate memory for the BITMAPINFO structure. (This structure</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>091</code></td><td class="content"><code class="comments">// contains a BITMAPINFOHEADER structure and an array of RGBQUAD</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>092</code></td><td class="content"><code class="comments">// data structures.)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>093</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>094</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(cClrBits != 24)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>095</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>096</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="plain">pbmi = (PBITMAPINFO) LocalAlloc(LPTR,</code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPINFOHEADER) + </code><code class="keyword bold">sizeof</code><code class="plain">(RGBQUAD) * (1&lt;&lt; cClrBits));</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>097</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>098</code></td><td class="content"><code class="comments">// There is no RGBQUAD array for the 24-bit-per-pixel format.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>099</code></td><td class="content"><code class="keyword bold">else</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>100</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="plain">pbmi = (PBITMAPINFO) LocalAlloc(LPTR, </code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPINFOHEADER));</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>101</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>102</code></td><td class="content"><code class="comments">// Initialize the fields in the BITMAPINFO structure.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>103</code></td><td class="content"><code class="plain">pbmi-&gt;bmiHeader.biSize = </code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPINFOHEADER);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>104</code></td><td class="content"><code class="plain">pbmi-&gt;bmiHeader.biWidth = bmp.bmWidth;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>105</code></td><td class="content"><code class="plain">pbmi-&gt;bmiHeader.biHeight = bmp.bmHeight;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>106</code></td><td class="content"><code class="plain">pbmi-&gt;bmiHeader.biPlanes = bmp.bmPlanes;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>107</code></td><td class="content"><code class="plain">pbmi-&gt;bmiHeader.biBitCount = bmp.bmBitsPixel;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>108</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(cClrBits &lt; 24)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>109</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>110</code></td><td class="content"><code class="spaces">&nbsp;</code><code class="plain">pbmi-&gt;bmiHeader.biClrUsed = (1&lt;&lt;cClrBits);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>111</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>112</code></td><td class="content"><code class="comments">// If the bitmap is not compressed, set the BI_RGB flag.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>113</code></td><td class="content"><code class="plain">pbmi-&gt;bmiHeader.biCompression = BI_RGB;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>114</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>115</code></td><td class="content"><code class="comments">// Compute the number of bytes in the array of color</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>116</code></td><td class="content"><code class="comments">// indices and store the result in biSizeImage.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>117</code></td><td class="content"><code class="comments">// For Windows NT, the width must be DWORD aligned unless</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>118</code></td><td class="content"><code class="comments">// the bitmap is RLE compressed. This example shows this.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>119</code></td><td class="content"><code class="comments">// For Windows 95/98/Me, the width must be WORD aligned unless the</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>120</code></td><td class="content"><code class="comments">// bitmap is RLE compressed.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>121</code></td><td class="content"><code class="plain">pbmi-&gt;bmiHeader.biSizeImage = ((pbmi-&gt;bmiHeader.biWidth * cClrBits +31) &amp; ~31) /8 * pbmi-&gt;bmiHeader.biHeight;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>122</code></td><td class="content"><code class="comments">// Set biClrImportant to 0, indicating that all of the</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>123</code></td><td class="content"><code class="comments">// device colors are important.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>124</code></td><td class="content"><code class="plain">pbmi-&gt;bmiHeader.biClrImportant = 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>125</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>126</code></td><td class="content"><code class="keyword bold">return</code> <code class="plain">pbmi; </code><code class="comments">//return BITMAPINFO</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>127</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div><br>
<br>
And Finally here is the full code for connecting a webcam in windows<br>
and grabbing a frame and saving it to the hard drive.<br>
<br>
<div class="syntaxhighlighter  " id="highlighter_21555"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_21555_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_21555" menu="false" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>001</code></td><td class="content"><code class="comments">//Setup some defines you need to connect to a webcam</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>002</code></td><td class="content"><code class="comments">//You can put these in a header</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>003</code></td><td class="content"><code class="comments">//If you are using Microsoft Visual Studio you wont need them as they</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>004</code></td><td class="content"><code class="comments">//Are included in Microsoft's version of vfw.h</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>005</code></td><td class="content"><code class="preprocessor">#define WM_CAP_START&nbsp; 0x0400</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>006</code></td><td class="content"><code class="preprocessor">#define WM_CAP_DRIVER_CONNECT&nbsp; (WM_CAP_START + 10)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>007</code></td><td class="content"><code class="preprocessor">#define WM_CAP_DRIVER_DISCONNECT&nbsp; (WM_CAP_START + 11)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>008</code></td><td class="content"><code class="preprocessor">#define WM_CAP_EDIT_COPY (WM_CAP_START + 30)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>009</code></td><td class="content"><code class="preprocessor">#define WM_CAP_GRAB_FRAME (WM_CAP_START + 60)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>010</code></td><td class="content"><code class="preprocessor">#define WM_CAP_SET_SCALE (WM_CAP_START + 53)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>011</code></td><td class="content"><code class="preprocessor">#define WM_CAP_SET_PREVIEWRATE (WM_CAP_START + 52)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>012</code></td><td class="content"><code class="preprocessor">#define WM_CAP_SET_PREVIEW (WM_CAP_START + 50)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>013</code></td><td class="content"><code class="preprocessor">#define WM_CAP_DLG_VIDEOSOURCE&nbsp; (WM_CAP_START + 42)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>014</code></td><td class="content"><code class="preprocessor">#define WM_CAP_STOP (WM_CAP_START+ 68)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>015</code></td><td class="content"><code class="comments">//End of defines</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>016</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>017</code></td><td class="content"><code class="preprocessor">#include &lt;windows.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>018</code></td><td class="content"><code class="preprocessor">#include &lt;vfw.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>019</code></td><td class="content"><code class="comments">//Remember to Link to vfw32 Library, gdi32 Library</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>020</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>021</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>022</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>023</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>024</code></td><td class="content"><code class="color1 bold">LRESULT</code> <code class="plain">CALLBACK WindowProc (</code><code class="color1 bold">HWND</code><code class="plain">, </code><code class="color1 bold">UINT</code><code class="plain">, </code><code class="color1 bold">WPARAM</code><code class="plain">, </code><code class="color1 bold">LPARAM</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>025</code></td><td class="content"><code class="plain">PBITMAPINFO CreateBitmapInfoStruct(</code><code class="color1 bold">HWND</code> <code class="plain">hwnd, </code><code class="color1 bold">HBITMAP</code> <code class="plain">hBmp);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>026</code></td><td class="content"><code class="keyword bold">void</code> <code class="plain">CreateBMPFile(</code><code class="color1 bold">HWND</code> <code class="plain">hwnd, </code><code class="color1 bold">LPTSTR</code> <code class="plain">pszFile, PBITMAPINFO pbi, </code><code class="color1 bold">HBITMAP</code> <code class="plain">hBMP, </code><code class="color1 bold">HDC</code> <code class="plain">hDC);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>027</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>028</code></td><td class="content"><code class="color1 bold">char</code> <code class="plain">szAppName [] = TEXT(</code><code class="string">"WebCam"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>029</code></td><td class="content"><code class="color1 bold">HWND</code> <code class="plain">camhwnd;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>030</code></td><td class="content"><code class="color1 bold">HDC</code> <code class="plain">hdc ;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>031</code></td><td class="content"><code class="color1 bold">HDC</code> <code class="plain">hdcMem;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>032</code></td><td class="content"><code class="plain">PAINTSTRUCT ps;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>033</code></td><td class="content"><code class="color1 bold">HBITMAP</code> <code class="plain">hbm;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>034</code></td><td class="content"><code class="plain">RECT rc;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>035</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>036</code></td><td class="content"><code class="comments">//WinMain -- Main Window</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>037</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">WINAPI WinMain ( </code><code class="color1 bold">HINSTANCE</code> <code class="plain">hInstance, </code><code class="color1 bold">HINSTANCE</code> <code class="plain">hPrevInstance,</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>038</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">LPSTR</code> <code class="plain">lpCmdLine, </code><code class="color1 bold">int</code> <code class="plain">nCmdShow )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>039</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>040</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>041</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">HWND</code> <code class="plain">hwnd;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>042</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">MSG msg;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>043</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>044</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">WNDCLASS wc;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>045</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wc.style = CS_HREDRAW|CS_VREDRAW;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>046</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wc.lpfnWndProc = WindowProc;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>047</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wc.cbClsExtra = 0;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>048</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wc.cbWndExtra = 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>049</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wc.hInstance = hInstance;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>050</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wc.hIcon = LoadIcon(GetModuleHandle(NULL), IDI_APPLICATION);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>051</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wc.hCursor = LoadCursor (NULL, IDC_ARROW);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>052</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wc.hbrBackground = (</code><code class="color1 bold">HBRUSH</code><code class="plain">) (COLOR_WINDOW+1);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>053</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wc.lpszMenuName = NULL;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>054</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">wc.lpszClassName = szAppName;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>055</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>056</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">RegisterClass (&amp;wc);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>057</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>058</code></td><td class="content"><code class="comments">// Create the window</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>059</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hwnd
 = CreateWindow 
(szAppName,szAppName,WS_OVERLAPPED|WS_CAPTION|WS_SYSMENU|WS_MINIMIZEBOX,CW_USEDEFAULT,CW_USEDEFAULT,300,600,0,0,hInstance,0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>060</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>061</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">ShowWindow (hwnd,SW_SHOW);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>062</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">UpdateWindow (hwnd);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>063</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>064</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">while</code> <code class="plain">(GetMessage(&amp;msg,0,0,0))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>065</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>066</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(!IsDialogMessage(hwnd, &amp;msg))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>067</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>068</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">TranslateMessage (&amp;msg);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>069</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">DispatchMessage (&amp;msg);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>070</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>071</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>072</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code> <code class="plain">msg.wParam;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>073</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>074</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>075</code></td><td class="content"><code class="comments">//Main Window Procedure WindowProc</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>076</code></td><td class="content"><code class="color1 bold">LRESULT</code> <code class="plain">CALLBACK WindowProc(</code><code class="color1 bold">HWND</code> <code class="plain">hwnd, </code><code class="color1 bold">UINT</code> <code class="plain">message, </code><code class="color1 bold">WPARAM</code> <code class="plain">wParam, </code><code class="color1 bold">LPARAM</code> <code class="plain">lParam)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>077</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>078</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">HINSTANCE</code> <code class="plain">hInstance = GetModuleHandle(NULL);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>079</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>080</code></td><td class="content"><code class="comments">//some buttons</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>081</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">HWND</code> <code class="plain">hButtStartCam;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>082</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">HWND</code> <code class="plain">hButtStopCam;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>083</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">HWND</code> <code class="plain">hButtGrabFrame;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>084</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>085</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">switch</code> <code class="plain">(message)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* handle the messages */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>086</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>087</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>088</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">case</code> <code class="plain">WM_CTLCOLORSTATIC:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>089</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SetBkMode(hdc,TRANSPARENT);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>090</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code> <code class="plain">(</code><code class="color1 bold">LRESULT</code><code class="plain">)CreateSolidBrush(0xFFFFFF);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>091</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>092</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">case</code> <code class="plain">WM_CREATE:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>093</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>094</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hButtStartCam = CreateWindowEx(0,</code><code class="string">"BUTTON"</code><code class="plain">,</code><code class="string">"Start Camera"</code><code class="plain">,WS_CHILD | WS_VISIBLE,</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>095</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">0,0,100,20,hwnd,(</code><code class="color1 bold">HMENU</code><code class="plain">)1,hInstance, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>096</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hButtStopCam = CreateWindowEx(0,</code><code class="string">"BUTTON"</code><code class="plain">,</code><code class="string">"Stop Camera"</code><code class="plain">,WS_CHILD | WS_VISIBLE,</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>097</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">0,25,100,20,hwnd,(</code><code class="color1 bold">HMENU</code><code class="plain">)2,hInstance, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>098</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hButtGrabFrame = CreateWindowEx(0,</code><code class="string">"BUTTON"</code><code class="plain">,</code><code class="string">"Grab Frame"</code><code class="plain">,WS_CHILD | WS_VISIBLE,</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>099</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">0,50,100,20,hwnd,(</code><code class="color1 bold">HMENU</code><code class="plain">)3,hInstance, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>100</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>101</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">camhwnd = capCreateCaptureWindow (</code><code class="string">"camera window"</code><code class="plain">, WS_CHILD , 0, 100, 300, 300, hwnd, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>102</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd,WM_CAP_DRIVER_CONNECT,0,0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>103</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd,WM_CAP_DLG_VIDEOSOURCE,0,0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>104</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>105</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>106</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>107</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>108</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">case</code> <code class="plain">WM_COMMAND:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>109</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>110</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">switch</code> <code class="plain">(LOWORD(wParam))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>111</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>112</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>113</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">case</code> <code class="plain">1:</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>114</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>115</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">ShowWindow(camhwnd,SW_SHOW);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>116</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd,WM_CAP_DRIVER_CONNECT,0,0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>117</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_SET_SCALE, </code><code class="keyword bold">true</code> <code class="plain">, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>118</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_SET_PREVIEWRATE, 66, 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>119</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_SET_PREVIEW, </code><code class="keyword bold">true</code> <code class="plain">, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>120</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>121</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>122</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>123</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">case</code> <code class="plain">2:</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>124</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>125</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">ShowWindow(camhwnd,SW_HIDE);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>126</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_DRIVER_DISCONNECT, 0, 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>127</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>128</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>129</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>130</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">case</code> <code class="plain">3:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>131</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>132</code></td><td class="content"><code class="comments">//Grab a Frame</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>133</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_GRAB_FRAME, 0, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>134</code></td><td class="content"><code class="comments">//Copy the frame we have just grabbed to the clipboard</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>135</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_EDIT_COPY,0,0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>136</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>137</code></td><td class="content"><code class="comments">//Copy the clipboard image data to a HBITMAP object called hbm</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>138</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hdc = BeginPaint(camhwnd, &amp;ps);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>139</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hdcMem = CreateCompatibleDC(hdc);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>140</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(hdcMem != NULL)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>141</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>142</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(OpenClipboard(camhwnd))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>143</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>144</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hbm = (</code><code class="color1 bold">HBITMAP</code><code class="plain">) GetClipboardData(CF_BITMAP);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>145</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SelectObject(hdcMem, hbm);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>146</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">GetClientRect(camhwnd, &amp;rc);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>147</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">CloseClipboard();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>148</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>149</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>150</code></td><td class="content"><code class="comments">//Save hbm to a .bmp file called Frame.bmp</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>151</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">PBITMAPINFO pbi = CreateBitmapInfoStruct(hwnd, hbm);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>152</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">CreateBMPFile(hwnd, </code><code class="string">"Frame.bmp"</code><code class="plain">, pbi, hbm, hdcMem);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>153</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>154</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd,WM_CAP_DRIVER_CONNECT,0,0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>155</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_SET_SCALE, </code><code class="keyword bold">true</code> <code class="plain">, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>156</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_SET_PREVIEWRATE, 66, 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>157</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_SET_PREVIEW, </code><code class="keyword bold">true</code> <code class="plain">, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>158</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>159</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>160</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>161</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>162</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>163</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>164</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">case</code> <code class="plain">WM_DESTROY:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>165</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>166</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_DRIVER_DISCONNECT, 0, 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>167</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">PostQuitMessage(0);&nbsp;&nbsp; </code><code class="comments">/* send a WM_QUIT to the message queue */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>168</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>169</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>170</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>171</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">default</code><code class="plain">:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* for messages that we don't deal with */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>172</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code> <code class="plain">DefWindowProc(hwnd, message, wParam, lParam);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>173</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>174</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code> <code class="plain">0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>175</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>176</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>177</code></td><td class="content"><code class="keyword bold">void</code> <code class="plain">CreateBMPFile(</code><code class="color1 bold">HWND</code> <code class="plain">hwnd, </code><code class="color1 bold">LPTSTR</code> <code class="plain">pszFile, PBITMAPINFO pbi, </code><code class="color1 bold">HBITMAP</code> <code class="plain">hBMP, </code><code class="color1 bold">HDC</code> <code class="plain">hDC)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>178</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>179</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">HANDLE</code> <code class="plain">hf;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// file handle</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>180</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">BITMAPFILEHEADER hdr;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// bitmap file-header</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>181</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">PBITMAPINFOHEADER pbih;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// bitmap info-header</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>182</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">LPBYTE</code> <code class="plain">lpBits;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// memory pointer</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>183</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">DWORD</code> <code class="plain">dwTotal;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// total count of bytes</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>184</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">DWORD</code> <code class="plain">cb;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// incremental count of bytes</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>185</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">BYTE</code> <code class="plain">*hp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// byte pointer</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>186</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">DWORD</code> <code class="plain">dwTmp;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>187</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>188</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pbih = (PBITMAPINFOHEADER) pbi;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>189</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">lpBits = (</code><code class="color1 bold">LPBYTE</code><code class="plain">) GlobalAlloc(GMEM_FIXED, pbih-&gt;biSizeImage);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>190</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>191</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(!lpBits)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>192</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>193</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">MessageBox(hwnd,</code><code class="string">"GlobalAlloc"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">, MB_OK );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>194</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>195</code></td><td class="content"><code class="comments">// Retrieve the color table (RGBQUAD array) and the bits</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>196</code></td><td class="content"><code class="comments">// (array of palette indices) from the DIB.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>197</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(!GetDIBits(hDC, hBMP, 0, (</code><code class="color1 bold">WORD</code><code class="plain">) pbih-&gt;biHeight, lpBits, pbi,DIB_RGB_COLORS))</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>198</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>199</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">MessageBox(hwnd,</code><code class="string">"GetDIBits"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">,MB_OK );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>200</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>201</code></td><td class="content"><code class="comments">// Create the .BMP file.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>202</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hf = CreateFile(pszFile,GENERIC_READ | GENERIC_WRITE,(</code><code class="color1 bold">DWORD</code><code class="plain">) 0,NULL,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,(</code><code class="color1 bold">HANDLE</code><code class="plain">) NULL);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>203</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(hf == INVALID_HANDLE_VALUE)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>204</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>205</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">MessageBox( hwnd,</code><code class="string">"CreateFile"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">, MB_OK);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>206</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>207</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>208</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hdr.bfType = 0x4d42;&nbsp; </code><code class="comments">// File type designator "BM" 0x42 = "B" 0x4d = "M"</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>209</code></td><td class="content"><code class="comments">// Compute the size of the entire file.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>210</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hdr.bfSize = (</code><code class="color1 bold">DWORD</code><code class="plain">) (</code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPFILEHEADER) + pbih-&gt;biSize + pbih-&gt;biClrUsed * </code><code class="keyword bold">sizeof</code><code class="plain">(RGBQUAD) + pbih-&gt;biSizeImage);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>211</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hdr.bfReserved1 = 0;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>212</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hdr.bfReserved2 = 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>213</code></td><td class="content"><code class="comments">// Compute the offset to the array of color indices.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>214</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hdr.bfOffBits = (</code><code class="color1 bold">DWORD</code><code class="plain">) </code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPFILEHEADER) + pbih-&gt;biSize + pbih-&gt;biClrUsed * </code><code class="keyword bold">sizeof</code> <code class="plain">(RGBQUAD);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>215</code></td><td class="content"><code class="comments">// Copy the BITMAPFILEHEADER into the .BMP file.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>216</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(!WriteFile(hf, (</code><code class="color1 bold">LPVOID</code><code class="plain">) &amp;hdr, </code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPFILEHEADER), (</code><code class="color1 bold">LPDWORD</code><code class="plain">) &amp;dwTmp,&nbsp; NULL) )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>217</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>218</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">MessageBox(hwnd,</code><code class="string">"WriteFileHeader"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">,MB_OK );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>219</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>220</code></td><td class="content"><code class="comments">// Copy the BITMAPINFOHEADER and RGBQUAD array into the file.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>221</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(!WriteFile(hf, (</code><code class="color1 bold">LPVOID</code><code class="plain">) pbih, </code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPINFOHEADER) + pbih-&gt;biClrUsed * </code><code class="keyword bold">sizeof</code> <code class="plain">(RGBQUAD), (</code><code class="color1 bold">LPDWORD</code><code class="plain">) &amp;dwTmp, NULL))</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>222</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>223</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">MessageBox(hwnd,</code><code class="string">"WriteInfoHeader"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">,MB_OK );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>224</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>225</code></td><td class="content"><code class="comments">// Copy the array of color indices into the .BMP file.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>226</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">dwTotal = cb = pbih-&gt;biSizeImage;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>227</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">hp = lpBits;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>228</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(!WriteFile(hf, (</code><code class="color1 bold">LPSTR</code><code class="plain">) hp, (</code><code class="color1 bold">int</code><code class="plain">) cb, (</code><code class="color1 bold">LPDWORD</code><code class="plain">) &amp;dwTmp,NULL))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>229</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>230</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">MessageBox(hwnd,</code><code class="string">"WriteFile"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">,MB_OK );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>231</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>232</code></td><td class="content"><code class="comments">// Close the .BMP file.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>233</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(!CloseHandle(hf))</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>234</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>235</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">MessageBox(hwnd,</code><code class="string">"CloseHandle"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">,MB_OK );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>236</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>237</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>238</code></td><td class="content"><code class="comments">// Free memory.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>239</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">GlobalFree((</code><code class="color1 bold">HGLOBAL</code><code class="plain">)lpBits);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>240</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>241</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>242</code></td><td class="content"><code class="plain">PBITMAPINFO CreateBitmapInfoStruct(</code><code class="color1 bold">HWND</code> <code class="plain">hwnd, </code><code class="color1 bold">HBITMAP</code> <code class="plain">hBmp)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>243</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>244</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">BITMAP bmp;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>245</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">PBITMAPINFO pbmi;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>246</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">WORD</code> <code class="plain">cClrBits;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>247</code></td><td class="content"><code class="comments">// Retrieve the bitmap color format, width, and height.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>248</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(!GetObject(hBmp, </code><code class="keyword bold">sizeof</code><code class="plain">(BITMAP), (</code><code class="color1 bold">LPSTR</code><code class="plain">)&amp;bmp))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>249</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>250</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">MessageBox(hwnd,</code><code class="string">"GetObject"</code><code class="plain">,</code><code class="string">"Error"</code><code class="plain">,MB_OK );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>251</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>252</code></td><td class="content"><code class="comments">// Convert the color format to a count of bits.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>253</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cClrBits = (</code><code class="color1 bold">WORD</code><code class="plain">)(bmp.bmPlanes * bmp.bmBitsPixel);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>254</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(cClrBits == 1)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>255</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cClrBits = 1;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>256</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">(cClrBits &lt;= 4)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>257</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cClrBits = 4;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>258</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">(cClrBits &lt;= 8)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>259</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cClrBits = 8;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>260</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">(cClrBits &lt;= 16)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>261</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cClrBits = 16;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>262</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">(cClrBits &lt;= 24)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>263</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cClrBits = 24;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>264</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="plain">cClrBits = 32;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>265</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>266</code></td><td class="content"><code class="comments">// Allocate memory for the BITMAPINFO structure. (This structure</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>267</code></td><td class="content"><code class="comments">// contains a BITMAPINFOHEADER structure and an array of RGBQUAD</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>268</code></td><td class="content"><code class="comments">// data structures.)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>269</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>270</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(cClrBits != 24)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>271</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>272</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pbmi = (PBITMAPINFO) LocalAlloc(LPTR,</code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPINFOHEADER) + </code><code class="keyword bold">sizeof</code><code class="plain">(RGBQUAD) * (1&lt;&lt; cClrBits));</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>273</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>274</code></td><td class="content"><code class="comments">// There is no RGBQUAD array for the 24-bit-per-pixel format.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>275</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>276</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pbmi = (PBITMAPINFO) LocalAlloc(LPTR, </code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPINFOHEADER));</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>277</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>278</code></td><td class="content"><code class="comments">// Initialize the fields in the BITMAPINFO structure.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>279</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pbmi-&gt;bmiHeader.biSize = </code><code class="keyword bold">sizeof</code><code class="plain">(BITMAPINFOHEADER);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>280</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pbmi-&gt;bmiHeader.biWidth = bmp.bmWidth;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>281</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pbmi-&gt;bmiHeader.biHeight = bmp.bmHeight;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>282</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pbmi-&gt;bmiHeader.biPlanes = bmp.bmPlanes;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>283</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pbmi-&gt;bmiHeader.biBitCount = bmp.bmBitsPixel;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>284</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(cClrBits &lt; 24)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>285</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>286</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pbmi-&gt;bmiHeader.biClrUsed = (1&lt;&lt;cClrBits);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>287</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>288</code></td><td class="content"><code class="comments">// If the bitmap is not compressed, set the BI_RGB flag.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>289</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pbmi-&gt;bmiHeader.biCompression = BI_RGB;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>290</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>291</code></td><td class="content"><code class="comments">// Compute the number of bytes in the array of color</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>292</code></td><td class="content"><code class="comments">// indices and store the result in biSizeImage.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>293</code></td><td class="content"><code class="comments">// For Windows NT, the width must be DWORD aligned unless</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>294</code></td><td class="content"><code class="comments">// the bitmap is RLE compressed. This example shows this.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>295</code></td><td class="content"><code class="comments">// For Windows 95/98/Me, the width must be WORD aligned unless the</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>296</code></td><td class="content"><code class="comments">// bitmap is RLE compressed.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>297</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pbmi-&gt;bmiHeader.biSizeImage = ((pbmi-&gt;bmiHeader.biWidth * cClrBits +31) &amp; ~31) /8 * pbmi-&gt;bmiHeader.biHeight;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>298</code></td><td class="content"><code class="comments">// Set biClrImportant to 0, indicating that all of the</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>299</code></td><td class="content"><code class="comments">// device colors are important.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>300</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">pbmi-&gt;bmiHeader.biClrImportant = 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>301</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>302</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code> <code class="plain">pbmi; </code><code class="comments">//return BITMAPINFO</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>303</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
<br>
</div>
<div style="padding-left: 15px;">
<script type="text/javascript">
//<![CDATA[
ord = window.ord || Math.floor(Math.random()*1E16);
document.write('<script type="text/javascript" src="http://ad2.netshelter.net/adj/ns.dreamincode/general;ppos=btf;kw=;tile=2;sz=300x250;ord=' + ord + '?"><\/script>');
//]]>
</script><script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/general_003.js"></script>
<noscript><a href="http://ad2.netshelter.net/jump/ns.dreamincode/general;ppos=btf;kw=;tile=2;sz=300x250;ord=123456789?" target="_blank"><img src="http://ad2.netshelter.net/ad/ns.dreamincode/general;ppos=btf;kw=;tile=2;sz=300x250;ord=123456789?" border="0" alt=""/></a></noscript>
</div>
<br>
</div>
<div class="rep_bar clear right" id="rep_post_1132474"><span style="float: left; margin-top: 10px; font-weight: bold;">
Is This A Good Question/Topic?
</span>
<span class="reputation positive rep_show clickable" title="Reputation" onclick="ipb.topic.repPopUp( this, 1132474 );">
5
</span>
<ul>
<li><a href="#" class="rep_up" title="Vote this post up"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/add.png" alt="+"></a></li>
</ul>
</div>
<script type="text/javascript">
					ipb.global.registerReputation( 'rep_post_1132474', { app: 'forums', type: 'pid', typeid: '1132474' }, parseInt('5') );
				</script>
<ul class="post_controls">
<li class="top hide"><a href="#top" class="top" title="Back to top">Back to top</a></li>
<li class="multiquote" id="multiq_1132474" style="">
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1132474" title="Quote this post with Multi-Quote"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> MultiQuote</a>
</li>
<li><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1132474" title="Reply directly to this post"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> Quote + Reply</a></li>
</ul>
<script type="text/javascript">
					// Show multiquote for JS browsers
					$('multiq_1132474').show();
					
					if( $('toggle_post_1132474') )
					{
						$('toggle_post_1132474').show();
					}
				</script>
</div>
</div>
<hr>
<h2 class="maintitle">
Replies To: Win32 WebCam Program
</h2>
<div class="post_block hentry clear  with_rep" id="post_id_1146218">
<a id="entry1146218"></a>
<div class="post_wrap">
<h3>
<span class="post_id">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__findpost__p__1146218" rel="bookmark" title="Link to post #2">#2</a>
</span>
<span class="author vcard">
<a class="url fn" href="http://www.dreamincode.net/forums/user/257701-aphex19/">Aphex19</a>
&nbsp;<a href="http://www.dreamincode.net/forums/user/257701-aphex19/page__f__48" class="__user __id257701 __fid48" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_popup.png" alt="Icon"></a>
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_off.png" alt="User is offline" title="User is offline">
</span>
</h3>
<div class="author_info">
<ul class="user_details">
<li class="avatar"><a href="http://www.dreamincode.net/forums/user/257701-aphex19/" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/av-257701.png" alt="" width="64" height="64"></a></li>
<li class="title">Born again Pastafarian</li>
<li class="group_icon">
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/author_group.gif" alt="member icon">
</li>
</ul>
<br>
<div class="reputation positive">
<span class="number">Reputation: 388</span>
</div>
<div style="margin: 0 auto;">
<ul class="user_controls clear">
<li><a href="http://www.dreamincode.net/forums/index.php?app=blog&amp;module=display&amp;section=blog&amp;mid=257701" title="View blog"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/book_open.png" alt="View blog"></a></li>
</ul>
</div>
<ul class="user_fields">
<li>
<span class="ft">Posts:</span>
<span class="fc">1,356</span>
</li>
<li>
<span class="ft">Joined:</span>
<span class="fc">02-August 09</span>
</li>
</ul>
</div>
<div class="post_body">
<p class="posted_info">
Posted <abbr class="published" title="2010-10-21T13:59:11+00:00">21 October 2010 - 06:59 AM</abbr>
</p>
<div class="post entry-content">
Thank you, this is very helpful to me. It's much appreciated.
<br>
</div>
</div>
<div class="rep_bar clear right" id="rep_post_1146218"><span style="float: left; margin-top: 10px; font-weight: bold;">
Was This Post Helpful?
</span>
<span class="reputation positive rep_show clickable" title="Reputation" onclick="ipb.topic.repPopUp( this, 1146218 );">
1
</span>
<ul>
<li><a href="#" class="rep_up" title="Vote this post up"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/add.png" alt="+"></a></li>
<li><a href="#" class="rep_down" title="Vote this post down"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/delete.png" alt="-"></a></li>
</ul>
</div>
<script type="text/javascript">
					ipb.global.registerReputation( 'rep_post_1146218', { app: 'forums', type: 'pid', typeid: '1146218' }, parseInt('1') );
				</script>
<ul class="post_controls">
<li class="top hide"><a href="#top" class="top" title="Back to top">Back to top</a></li>
<li class="multiquote" id="multiq_1146218" style="">
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1146218" title="Quote this post with Multi-Quote"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> MultiQuote</a>
</li>
<li><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1146218" title="Reply directly to this post"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> Quote + Reply</a></li>
</ul>
<script type="text/javascript">
					// Show multiquote for JS browsers
					$('multiq_1146218').show();
					
					if( $('toggle_post_1146218') )
					{
						$('toggle_post_1146218').show();
					}
				</script>
</div>
</div>
<hr>
<div class="post_block hentry clear  with_rep" id="post_id_1146563">
<a id="entry1146563"></a>
<div class="post_wrap">
<h3>
<span class="post_id">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__findpost__p__1146563" rel="bookmark" title="Link to post #3">#3</a>
</span>
<span class="author vcard">
<a class="url fn" href="http://www.dreamincode.net/forums/user/358927-snoopy11/">snoopy11</a>
&nbsp;<a href="http://www.dreamincode.net/forums/user/358927-snoopy11/page__f__48" class="__user __id358927 __fid48" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_popup.png" alt="Icon"></a>
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_off.png" alt="User is offline" title="User is offline">
</span>
</h3>
<div class="author_info">
<ul class="user_details">
<li class="avatar"><a href="http://www.dreamincode.net/forums/user/358927-snoopy11/" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/av-358927.jpg" alt="" width="52" height="64"></a></li>
<li class="title">D.I.C Regular</li>
<li class="group_icon">
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/author_group.gif" alt="member icon">
</li>
</ul>
<br>
<div class="reputation positive">
<span class="number">Reputation: 131</span>
</div>
<div style="margin: 0 auto;">
<ul class="user_controls clear">
<li><a href="http://www.dreamincode.net/forums/index.php?app=blog&amp;module=display&amp;section=blog&amp;mid=358927" title="View blog"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/book_open.png" alt="View blog"></a></li>
</ul>
</div>
<ul class="user_fields">
<li>
<span class="ft">Posts:</span>
<span class="fc">473</span>
</li>
<li>
<span class="ft">Joined:</span>
<span class="fc">20-March 10</span>
</li>
</ul>
</div>
<div class="post_body">
<p class="posted_info">
Posted <abbr class="published" title="2010-10-21T19:40:04+00:00">21 October 2010 - 12:40 PM</abbr>
</p>
<div class="post entry-content">
@ Aphex19<br>
<br>
Thats ok glad I could be of help.<br>
<br>
Thanks for your reply.<br>
<br>
Snoopy.
<br>
</div>
</div>
<div class="rep_bar clear right" id="rep_post_1146563"><span style="float: left; margin-top: 10px; font-weight: bold;">
Was This Post Helpful?
</span>
<span class="reputation positive rep_show clickable" title="Reputation" onclick="ipb.topic.repPopUp( this, 1146563 );">
1
</span>
<ul>
<li><a href="#" class="rep_up" title="Vote this post up"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/add.png" alt="+"></a></li>
<li><a href="#" class="rep_down" title="Vote this post down"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/delete.png" alt="-"></a></li>
</ul>
</div>
<script type="text/javascript">
					ipb.global.registerReputation( 'rep_post_1146563', { app: 'forums', type: 'pid', typeid: '1146563' }, parseInt('1') );
				</script>
<ul class="post_controls">
<li class="top hide"><a href="#top" class="top" title="Back to top">Back to top</a></li>
<li class="multiquote" id="multiq_1146563" style="">
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1146563" title="Quote this post with Multi-Quote"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> MultiQuote</a>
</li>
<li><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1146563" title="Reply directly to this post"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> Quote + Reply</a></li>
</ul>
<script type="text/javascript">
					// Show multiquote for JS browsers
					$('multiq_1146563').show();
					
					if( $('toggle_post_1146563') )
					{
						$('toggle_post_1146563').show();
					}
				</script>
</div>
</div>
<hr>
<div class="post_block hentry clear  with_rep" id="post_id_1256533">
<a id="entry1256533"></a>
<div class="post_wrap">
<h3 class="guest">
<span class="post_id">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__findpost__p__1256533" rel="bookmark" title="Link to post #4">#4</a>
</span>
Guest_Footman*
</h3>
<div class="author_info">
<ul class="user_details">
<li class="avatar"></li>
</ul>
<br>
<div class="reputation zero">
<span class="number">Reputation: </span>
</div>
<div style="margin: 0 auto;">
<ul class="user_controls clear">
</ul>
</div>
<ul class="user_fields">
</ul>
</div>
<div class="post_body">
<p class="posted_info">
Posted <abbr class="published" title="2011-02-19T15:07:32+00:00">19 February 2011 - 08:07 AM</abbr>
</p>
<div class="post entry-content">
<p class="citation"><a class="snapback" rel="citation" href="http://www.dreamincode.net/forums/index.php?s=f9ceebcf98cf66cad7bd97857816f141&amp;app=forums&amp;module=forums&amp;section=findpost&amp;pid=1146563"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/snapback.png" alt="View Post"></a>snoopy11, on 21 October 2010 - 12:40 PM, said:</p><div class="blockquote"><div class="quote">@ Aphex19<br>
<br>
Thats ok glad I could be of help.<br>
<br>
Thanks for your reply.<br>
<br>
Snoopy.</div></div>
<br>
</div>
</div>
<div class="rep_bar clear right" id="rep_post_1256533"><span style="float: left; margin-top: 10px; font-weight: bold;">
Was This Post Helpful?
</span>
<span class="reputation positive rep_show clickable" title="Reputation" onclick="ipb.topic.repPopUp( this, 1256533 );">
1
</span>
</div>
<script type="text/javascript">
					ipb.global.registerReputation( 'rep_post_1256533', { app: 'forums', type: 'pid', typeid: '1256533' }, parseInt('1') );
				</script>
<ul class="post_controls">
<li class="top hide"><a href="#top" class="top" title="Back to top">Back to top</a></li>
<li class="multiquote" id="multiq_1256533" style="">
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1256533" title="Quote this post with Multi-Quote"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> MultiQuote</a>
</li>
<li><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1256533" title="Reply directly to this post"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> Quote + Reply</a></li>
</ul>
<script type="text/javascript">
					// Show multiquote for JS browsers
					$('multiq_1256533').show();
					
					if( $('toggle_post_1256533') )
					{
						$('toggle_post_1256533').show();
					}
				</script>
</div>
</div>
<hr>
<div class="post_block hentry clear  with_rep" id="post_id_1256539">
<a id="entry1256539"></a>
<div class="post_wrap">
<h3 class="guest">
<span class="post_id">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__findpost__p__1256539" rel="bookmark" title="Link to post #5">#5</a>
</span>
Guest_Footman*
</h3>
<div class="author_info">
<ul class="user_details">
<li class="avatar"></li>
</ul>
<br>
<div class="reputation zero">
<span class="number">Reputation: </span>
</div>
<div style="margin: 0 auto;">
<ul class="user_controls clear">
</ul>
</div>
<ul class="user_fields">
</ul>
</div>
<div class="post_body">
<p class="posted_info">
Posted <abbr class="published" title="2011-02-19T15:15:30+00:00">19 February 2011 - 08:15 AM</abbr>
</p>
<div class="post entry-content">
Hello,<br>
Thank you at first for this tutorial. It worked fine for me for 2 weeks,
 but now i have strange bug : the preview window is black.<br>
Cam is on and i can get some snapshots but i don't see anything in 
preview screen. Same script works good in VB.Net but not in c++.<br>
I have vc++ pro Edition and Sony Vaio standard webcam. Do you have some solutions for this problem?
<br>
</div>
</div>
<div class="rep_bar clear right" id="rep_post_1256539"><span style="float: left; margin-top: 10px; font-weight: bold;">
Was This Post Helpful?
</span>
<span class="reputation zero rep_show clickable" title="Reputation" onclick="ipb.topic.repPopUp( this, 1256539 );">
0
</span>
</div>
<script type="text/javascript">
					ipb.global.registerReputation( 'rep_post_1256539', { app: 'forums', type: 'pid', typeid: '1256539' }, parseInt('0') );
				</script>
<ul class="post_controls">
<li class="top hide"><a href="#top" class="top" title="Back to top">Back to top</a></li>
<li class="multiquote" id="multiq_1256539" style="">
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1256539" title="Quote this post with Multi-Quote"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> MultiQuote</a>
</li>
<li><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1256539" title="Reply directly to this post"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> Quote + Reply</a></li>
</ul>
<script type="text/javascript">
					// Show multiquote for JS browsers
					$('multiq_1256539').show();
					
					if( $('toggle_post_1256539') )
					{
						$('toggle_post_1256539').show();
					}
				</script>
</div>
</div>
<hr>
<div class="post_block hentry clear  with_rep" id="post_id_1259961">
<a id="entry1259961"></a>
<div class="post_wrap">
<h3 class="guest">
<span class="post_id">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__findpost__p__1259961" rel="bookmark" title="Link to post #6">#6</a>
</span>
Guest_Marref*
</h3>
<div class="author_info">
<ul class="user_details">
<li class="avatar"></li>
</ul>
<br>
<div class="reputation zero">
<span class="number">Reputation: </span>
</div>
<div style="margin: 0 auto;">
<ul class="user_controls clear">
</ul>
</div>
<ul class="user_fields">
</ul>
</div>
<div class="post_body">
<p class="posted_info">
Posted <abbr class="published" title="2011-02-22T20:47:47+00:00">22 February 2011 - 01:47 PM</abbr>
</p>
<div class="post entry-content">
1&gt;LINK : fatal error LNK1104: impossible d'ouvrir le fichier 'Vfw32.libkernel32.lib'<br>
What is the probleme ?<br>
how can I resolve it <br>
P.S: I have a windows 64 bits
<br>
</div>
</div>
<div class="rep_bar clear right" id="rep_post_1259961"><span style="float: left; margin-top: 10px; font-weight: bold;">
Was This Post Helpful?
</span>
<span class="reputation positive rep_show clickable" title="Reputation" onclick="ipb.topic.repPopUp( this, 1259961 );">
1
</span>
</div>
<script type="text/javascript">
					ipb.global.registerReputation( 'rep_post_1259961', { app: 'forums', type: 'pid', typeid: '1259961' }, parseInt('1') );
				</script>
<ul class="post_controls">
<li class="top hide"><a href="#top" class="top" title="Back to top">Back to top</a></li>
<li class="multiquote" id="multiq_1259961" style="">
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1259961" title="Quote this post with Multi-Quote"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> MultiQuote</a>
</li>
<li><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1259961" title="Reply directly to this post"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> Quote + Reply</a></li>
</ul>
<script type="text/javascript">
					// Show multiquote for JS browsers
					$('multiq_1259961').show();
					
					if( $('toggle_post_1259961') )
					{
						$('toggle_post_1259961').show();
					}
				</script>
</div>
</div>
<hr>
<div class="post_block hentry clear  with_rep" id="post_id_1280496">
<a id="entry1280496"></a>
<div class="post_wrap">
<h3>
<span class="post_id">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__findpost__p__1280496" rel="bookmark" title="Link to post #7">#7</a>
</span>
<span class="author vcard">
<a class="url fn" href="http://www.dreamincode.net/forums/user/358927-snoopy11/">snoopy11</a>
&nbsp;<a href="http://www.dreamincode.net/forums/user/358927-snoopy11/page__f__48" class="__user __id358927 __fid48" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_popup.png" alt="Icon"></a>
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_off.png" alt="User is offline" title="User is offline">
</span>
</h3>
<div class="author_info">
<ul class="user_details">
<li class="avatar"><a href="http://www.dreamincode.net/forums/user/358927-snoopy11/" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/av-358927.jpg" alt="" width="52" height="64"></a></li>
<li class="title">D.I.C Regular</li>
<li class="group_icon">
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/author_group.gif" alt="member icon">
</li>
</ul>
<br>
<div class="reputation positive">
<span class="number">Reputation: 131</span>
</div>
<div style="margin: 0 auto;">
<ul class="user_controls clear">
<li><a href="http://www.dreamincode.net/forums/index.php?app=blog&amp;module=display&amp;section=blog&amp;mid=358927" title="View blog"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/book_open.png" alt="View blog"></a></li>
</ul>
</div>
<ul class="user_fields">
<li>
<span class="ft">Posts:</span>
<span class="fc">473</span>
</li>
<li>
<span class="ft">Joined:</span>
<span class="fc">20-March 10</span>
</li>
</ul>
</div>
<div class="post_body">
<p class="posted_info">
Posted <abbr class="published" title="2011-03-14T19:45:42+00:00">14 March 2011 - 12:45 PM</abbr>
</p>
<div class="post entry-content">
<p class="citation"><a class="snapback" rel="citation" href="http://www.dreamincode.net/forums/index.php?s=f9ceebcf98cf66cad7bd97857816f141&amp;app=forums&amp;module=forums&amp;section=findpost&amp;pid=1256539"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/snapback.png" alt="View Post"></a>Footman, on 19 February 2011 - 08:15 AM, said:</p><div class="blockquote"><div class="quote">Hello,<br>
Thank you at first for this tutorial. It worked fine for me for 2 weeks,
 but now i have strange bug : the preview window is black.<br>
Cam is on and i can get some snapshots but i don't see anything in 
preview screen. Same script works good in VB.Net but not in c++.<br>
I have vc++ pro Edition and Sony Vaio standard webcam. Do you have some solutions for this problem?</div></div><br>
<br>
It sounds like you have a problem with your usb root hub that you have the cam connected to try the following at wikiHow<br>
<br>
<a href="http://www.wikihow.com/Fix-a-Webcam-That-Is-Displaying-a-Black-Screen-on-Windows" class="bbc_url" title="External link" rel="external">How to fix a webcam that is displaying a blank screen</a><br>
<br>
let me know how you get on.<br><br><p class="citation"><a class="snapback" rel="citation" href="http://www.dreamincode.net/forums/index.php?s=f9ceebcf98cf66cad7bd97857816f141&amp;app=forums&amp;module=forums&amp;section=findpost&amp;pid=1259961"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/snapback.png" alt="View Post"></a>Marref, on 22 February 2011 - 01:47 PM, said:</p><div class="blockquote"><div class="quote">1&gt;LINK : fatal error LNK1104: impossible d'ouvrir le fichier 'Vfw32.libkernel32.lib'<br>
What is the probleme ?<br>
how can I resolve it <br>
P.S: I have a windows 64 bits</div></div><br>
<br>
you have to link to vfw32.lib and kernel32.lib for this program to work refer<br>
to you compiler instructions on how to link to libraries.
<br>
</div>
</div>
<div class="rep_bar clear right" id="rep_post_1280496"><span style="float: left; margin-top: 10px; font-weight: bold;">
Was This Post Helpful?
</span>
<span class="reputation zero rep_show clickable" title="Reputation" onclick="ipb.topic.repPopUp( this, 1280496 );">
0
</span>
<ul>
<li><a href="#" class="rep_up" title="Vote this post up"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/add.png" alt="+"></a></li>
<li><a href="#" class="rep_down" title="Vote this post down"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/delete.png" alt="-"></a></li>
</ul>
</div>
<script type="text/javascript">
					ipb.global.registerReputation( 'rep_post_1280496', { app: 'forums', type: 'pid', typeid: '1280496' }, parseInt('0') );
				</script>
<ul class="post_controls">
<li class="top hide"><a href="#top" class="top" title="Back to top">Back to top</a></li>
<li class="multiquote" id="multiq_1280496" style="">
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1280496" title="Quote this post with Multi-Quote"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> MultiQuote</a>
</li>
<li><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1280496" title="Reply directly to this post"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> Quote + Reply</a></li>
</ul>
<script type="text/javascript">
					// Show multiquote for JS browsers
					$('multiq_1280496').show();
					
					if( $('toggle_post_1280496') )
					{
						$('toggle_post_1280496').show();
					}
				</script>
</div>
</div>
<hr>
<div class="post_block hentry clear  with_rep" id="post_id_1315432">
<a id="entry1315432"></a>
<div class="post_wrap">
<h3>
<span class="post_id">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__findpost__p__1315432" rel="bookmark" title="Link to post #8">#8</a>
</span>
<span class="author vcard">
<a class="url fn" href="http://www.dreamincode.net/forums/user/502291-ryanmills/">ryanmills</a>
&nbsp;<a href="http://www.dreamincode.net/forums/user/502291-ryanmills/page__f__48" class="__user __id502291 __fid48" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_popup.png" alt="Icon"></a>
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_off.png" alt="User is offline" title="User is offline">
</span>
</h3>
<div class="author_info">
<ul class="user_details">
<li class="avatar"><a href="http://www.dreamincode.net/forums/user/502291-ryanmills/" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/6099b64ab2080c9b5194f2498c1a6395.jpg" alt=""></a></li>
<li class="title">New D.I.C Head</li>
</ul>
<br>
<div class="reputation zero">
<span class="number">Reputation: 0</span>
</div>
<div style="margin: 0 auto;">
<ul class="user_controls clear">
<li><a href="http://www.dreamincode.net/forums/index.php?app=blog&amp;module=display&amp;section=blog&amp;mid=502291" title="View blog"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/book_open.png" alt="View blog"></a></li>
</ul>
</div>
<ul class="user_fields">
<li>
<span class="ft">Posts:</span>
<span class="fc">1</span>
</li>
<li>
<span class="ft">Joined:</span>
<span class="fc">19-April 11</span>
</li>
</ul>
</div>
<div class="post_body">
<p class="posted_info">
Posted <abbr class="published" title="2011-04-19T07:30:47+00:00">19 April 2011 - 12:30 AM</abbr>
</p>
<div class="post entry-content">
Error in VC++ 2010 Express (sdk installed) Windows 7<br>
<br>
------ Build started: Project: CameraTest, Configuration: Debug Win32 ------<br>
MSVCRTD.lib(crtexe.obj) : error LNK2019: unresolved external symbol _main referenced in function ___tmainCRTStartup<br>
C:\Users\ryan\documents\visual studio 
2010\Projects\CameraTest\Debug\CameraTest.exe : fatal error LNK1120: 1 
unresolved externals<br>
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========<br>
<br>
<br>
Thoughts
<br>
</div>
</div>
<div class="rep_bar clear right" id="rep_post_1315432"><span style="float: left; margin-top: 10px; font-weight: bold;">
Was This Post Helpful?
</span>
<span class="reputation zero rep_show clickable" title="Reputation" onclick="ipb.topic.repPopUp( this, 1315432 );">
0
</span>
<ul>
<li><a href="#" class="rep_up" title="Vote this post up"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/add.png" alt="+"></a></li>
<li><a href="#" class="rep_down" title="Vote this post down"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/delete.png" alt="-"></a></li>
</ul>
</div>
<script type="text/javascript">
					ipb.global.registerReputation( 'rep_post_1315432', { app: 'forums', type: 'pid', typeid: '1315432' }, parseInt('0') );
				</script>
<ul class="post_controls">
<li class="top hide"><a href="#top" class="top" title="Back to top">Back to top</a></li>
<li class="multiquote" id="multiq_1315432" style="">
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1315432" title="Quote this post with Multi-Quote"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> MultiQuote</a>
</li>
<li><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1315432" title="Reply directly to this post"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> Quote + Reply</a></li>
</ul>
<script type="text/javascript">
					// Show multiquote for JS browsers
					$('multiq_1315432').show();
					
					if( $('toggle_post_1315432') )
					{
						$('toggle_post_1315432').show();
					}
				</script>
</div>
</div>
<hr>
<div class="post_block hentry clear  with_rep" id="post_id_1340751">
<a id="entry1340751"></a>
<div class="post_wrap">
<h3>
<span class="post_id">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__findpost__p__1340751" rel="bookmark" title="Link to post #9">#9</a>
</span>
<span class="author vcard">
<a class="url fn" href="http://www.dreamincode.net/forums/user/358927-snoopy11/">snoopy11</a>
&nbsp;<a href="http://www.dreamincode.net/forums/user/358927-snoopy11/page__f__48" class="__user __id358927 __fid48" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_popup.png" alt="Icon"></a>
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_off.png" alt="User is offline" title="User is offline">
</span>
</h3>
<div class="author_info">
<ul class="user_details">
<li class="avatar"><a href="http://www.dreamincode.net/forums/user/358927-snoopy11/" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/av-358927.jpg" alt="" width="52" height="64"></a></li>
<li class="title">D.I.C Regular</li>
<li class="group_icon">
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/author_group.gif" alt="member icon">
</li>
</ul>
<br>
<div class="reputation positive">
<span class="number">Reputation: 131</span>
</div>
<div style="margin: 0 auto;">
<ul class="user_controls clear">
<li><a href="http://www.dreamincode.net/forums/index.php?app=blog&amp;module=display&amp;section=blog&amp;mid=358927" title="View blog"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/book_open.png" alt="View blog"></a></li>
</ul>
</div>
<ul class="user_fields">
<li>
<span class="ft">Posts:</span>
<span class="fc">473</span>
</li>
<li>
<span class="ft">Joined:</span>
<span class="fc">20-March 10</span>
</li>
</ul>
</div>
<div class="post_body">
<p class="posted_info">
Posted <abbr class="published" title="2011-05-17T07:12:13+00:00">17 May 2011 - 12:12 AM</abbr>
</p>
<div class="post entry-content">
It sounds like you are trying to build this as a console application<br>
this is a windows application so try building it as a Win32 project !!
<br>
</div>
</div>
<div class="rep_bar clear right" id="rep_post_1340751"><span style="float: left; margin-top: 10px; font-weight: bold;">
Was This Post Helpful?
</span>
<span class="reputation zero rep_show clickable" title="Reputation" onclick="ipb.topic.repPopUp( this, 1340751 );">
0
</span>
<ul>
<li><a href="#" class="rep_up" title="Vote this post up"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/add.png" alt="+"></a></li>
<li><a href="#" class="rep_down" title="Vote this post down"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/delete.png" alt="-"></a></li>
</ul>
</div>
<script type="text/javascript">
					ipb.global.registerReputation( 'rep_post_1340751', { app: 'forums', type: 'pid', typeid: '1340751' }, parseInt('0') );
				</script>
<ul class="post_controls">
<li class="top hide"><a href="#top" class="top" title="Back to top">Back to top</a></li>
<li class="multiquote" id="multiq_1340751" style="">
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1340751" title="Quote this post with Multi-Quote"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> MultiQuote</a>
</li>
<li><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1340751" title="Reply directly to this post"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> Quote + Reply</a></li>
</ul>
<script type="text/javascript">
					// Show multiquote for JS browsers
					$('multiq_1340751').show();
					
					if( $('toggle_post_1340751') )
					{
						$('toggle_post_1340751').show();
					}
				</script>
</div>
</div>
<hr>
<div class="post_block hentry clear  with_rep" id="post_id_1370727">
<a id="entry1370727"></a>
<div class="post_wrap">
<h3>
<span class="post_id">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__findpost__p__1370727" rel="bookmark" title="Link to post #10">#10</a>
</span>
<span class="author vcard">
<a class="url fn" href="http://www.dreamincode.net/forums/user/518863-tau-neutrino/">tau_neutrino</a>
&nbsp;<a href="http://www.dreamincode.net/forums/user/518863-tau-neutrino/page__f__48" class="__user __id518863 __fid48" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_popup.png" alt="Icon"></a>
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_off.png" alt="User is offline" title="User is offline">
</span>
</h3>
<div class="author_info">
<ul class="user_details">
<li class="avatar"><a href="http://www.dreamincode.net/forums/user/518863-tau-neutrino/" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/1b95653d2b69961f5a33dccb40ffc33d.gif" alt=""></a></li>
<li class="title">New D.I.C Head</li>
</ul>
<br>
<div class="reputation zero">
<span class="number">Reputation: 0</span>
</div>
<div style="margin: 0 auto;">
<ul class="user_controls clear">
<li><a href="http://www.dreamincode.net/forums/index.php?app=blog&amp;module=display&amp;section=blog&amp;mid=518863" title="View blog"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/book_open.png" alt="View blog"></a></li>
</ul>
</div>
<ul class="user_fields">
<li>
<span class="ft">Posts:</span>
<span class="fc">1</span>
</li>
<li>
<span class="ft">Joined:</span>
<span class="fc">24-June 11</span>
</li>
</ul>
</div>
<div class="post_body">
<p class="posted_info">
Posted <abbr class="published" title="2011-06-24T13:32:13+00:00">24 June 2011 - 06:32 AM</abbr>
</p>
<div class="post entry-content">
snoopy11, thank you for the article!<br>
Why don't you use WM_CAP_FILE_SAVEDIB? It will save a file in a single call, won't it?<br>
<br>
My problem with this code is that using clipboard is very annoying. Is there any other way to get the frames grabbed? Thanks!
<br>
</div>
</div>
<div class="rep_bar clear right" id="rep_post_1370727"><span style="float: left; margin-top: 10px; font-weight: bold;">
Was This Post Helpful?
</span>
<span class="reputation zero rep_show clickable" title="Reputation" onclick="ipb.topic.repPopUp( this, 1370727 );">
0
</span>
<ul>
<li><a href="#" class="rep_up" title="Vote this post up"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/add.png" alt="+"></a></li>
<li><a href="#" class="rep_down" title="Vote this post down"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/delete.png" alt="-"></a></li>
</ul>
</div>
<script type="text/javascript">
					ipb.global.registerReputation( 'rep_post_1370727', { app: 'forums', type: 'pid', typeid: '1370727' }, parseInt('0') );
				</script>
<ul class="post_controls">
<li class="top hide"><a href="#top" class="top" title="Back to top">Back to top</a></li>
<li class="multiquote" id="multiq_1370727" style="">
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1370727" title="Quote this post with Multi-Quote"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> MultiQuote</a>
</li>
<li><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1370727" title="Reply directly to this post"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> Quote + Reply</a></li>
</ul>
<script type="text/javascript">
					// Show multiquote for JS browsers
					$('multiq_1370727').show();
					
					if( $('toggle_post_1370727') )
					{
						$('toggle_post_1370727').show();
					}
				</script>
</div>
</div>
<hr>
<div class="post_block hentry clear  with_rep" id="post_id_1383076">
<a id="entry1383076"></a>
<div class="post_wrap">
<h3>
<span class="post_id">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__findpost__p__1383076" rel="bookmark" title="Link to post #11">#11</a>
</span>
<span class="author vcard">
<a class="url fn" href="http://www.dreamincode.net/forums/user/524179-deca/">Deca</a>
&nbsp;<a href="http://www.dreamincode.net/forums/user/524179-deca/page__f__48" class="__user __id524179 __fid48" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_popup.png" alt="Icon"></a>
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_off.png" alt="User is offline" title="User is offline">
</span>
</h3>
<div class="author_info">
<ul class="user_details">
<li class="avatar"><a href="http://www.dreamincode.net/forums/user/524179-deca/" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/82625c19511565bf4421c7e64bc97e68.gif" alt=""></a></li>
<li class="title">New D.I.C Head</li>
</ul>
<br>
<div class="reputation zero">
<span class="number">Reputation: 0</span>
</div>
<div style="margin: 0 auto;">
<ul class="user_controls clear">
<li><a href="http://www.dreamincode.net/forums/index.php?app=blog&amp;module=display&amp;section=blog&amp;mid=524179" title="View blog"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/book_open.png" alt="View blog"></a></li>
</ul>
</div>
<ul class="user_fields">
<li>
<span class="ft">Posts:</span>
<span class="fc">7</span>
</li>
<li>
<span class="ft">Joined:</span>
<span class="fc">09-July 11</span>
</li>
</ul>
</div>
<div class="post_body">
<p class="posted_info">
Posted <abbr class="published" title="2011-07-09T21:36:18+00:00">09 July 2011 - 02:36 PM</abbr>
</p>
<div class="post entry-content">
nice artical
<br>
</div>
</div>
<div class="rep_bar clear right" id="rep_post_1383076"><span style="float: left; margin-top: 10px; font-weight: bold;">
Was This Post Helpful?
</span>
<span class="reputation zero rep_show clickable" title="Reputation" onclick="ipb.topic.repPopUp( this, 1383076 );">
0
</span>
<ul>
<li><a href="#" class="rep_up" title="Vote this post up"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/add.png" alt="+"></a></li>
<li><a href="#" class="rep_down" title="Vote this post down"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/delete.png" alt="-"></a></li>
</ul>
</div>
<script type="text/javascript">
					ipb.global.registerReputation( 'rep_post_1383076', { app: 'forums', type: 'pid', typeid: '1383076' }, parseInt('0') );
				</script>
<ul class="post_controls">
<li class="top hide"><a href="#top" class="top" title="Back to top">Back to top</a></li>
<li class="multiquote" id="multiq_1383076" style="">
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1383076" title="Quote this post with Multi-Quote"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> MultiQuote</a>
</li>
<li><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1383076" title="Reply directly to this post"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> Quote + Reply</a></li>
</ul>
<script type="text/javascript">
					// Show multiquote for JS browsers
					$('multiq_1383076').show();
					
					if( $('toggle_post_1383076') )
					{
						$('toggle_post_1383076').show();
					}
				</script>
</div>
</div>
<hr>
<div class="post_block hentry clear  with_rep" id="post_id_1393151">
<a id="entry1393151"></a>
<div class="post_wrap">
<h3>
<span class="post_id">
<a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__findpost__p__1393151" rel="bookmark" title="Link to post #12">#12</a>
</span>
<span class="author vcard">
<a class="url fn" href="http://www.dreamincode.net/forums/user/358927-snoopy11/">snoopy11</a>
&nbsp;<a href="http://www.dreamincode.net/forums/user/358927-snoopy11/page__f__48" class="__user __id358927 __fid48" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_popup.png" alt="Icon"></a>
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/user_off.png" alt="User is offline" title="User is offline">
</span>
</h3>
<div class="author_info">
<ul class="user_details">
<li class="avatar"><a href="http://www.dreamincode.net/forums/user/358927-snoopy11/" title="View Profile"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/av-358927.jpg" alt="" width="52" height="64"></a></li>
<li class="title">D.I.C Regular</li>
<li class="group_icon">
<img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/author_group.gif" alt="member icon">
</li>
</ul>
<br>
<div class="reputation positive">
<span class="number">Reputation: 131</span>
</div>
<div style="margin: 0 auto;">
<ul class="user_controls clear">
<li><a href="http://www.dreamincode.net/forums/index.php?app=blog&amp;module=display&amp;section=blog&amp;mid=358927" title="View blog"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/book_open.png" alt="View blog"></a></li>
</ul>
</div>
<ul class="user_fields">
<li>
<span class="ft">Posts:</span>
<span class="fc">473</span>
</li>
<li>
<span class="ft">Joined:</span>
<span class="fc">20-March 10</span>
</li>
</ul>
</div>
<div class="post_body">
<p class="posted_info">
Posted <abbr class="published" title="2011-07-21T05:54:22+00:00">20 July 2011 - 10:54 PM</abbr>
</p>
<div class="post entry-content">
<p class="citation"><a class="snapback" rel="citation" href="http://www.dreamincode.net/forums/index.php?s=ec6023731021551920ee43120b6b7985&amp;app=forums&amp;module=forums&amp;section=findpost&amp;pid=1370727"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/snapback.png" alt="View Post"></a>tau_neutrino, on 24 June 2011 - 06:32 AM, said:</p><div class="blockquote"><div class="quote">snoopy11, thank you for the article!<br>
Why don't you use WM_CAP_FILE_SAVEDIB? It will save a file in a single call, won't it?<br>
<br>
My problem with this code is that using clipboard is very annoying. Is there any other way to get the frames grabbed? Thanks!</div></div><br>
<br>
<br>
Yes it will my reasons for doing it this way was simply to write<br>
my own .bmp saving routine which i was interested in doing at the time....<br>
<br>
if you are <strong class="bbc">not</strong> using microsoft visual c++<br>
<br>
then you will need to add this define.<br>
<br>
<div class="syntaxhighlighter  " id="highlighter_131797"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_131797_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_131797" menu="false" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="preprocessor">#define WM_CAP_FILE_SAVEDIB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (WM_CAP_START+&nbsp; 25)</code></td></tr></tbody></table></div></div></div><br>
<br>
then ammend case 3 inside <strong class="bbc">WM_COMMAND</strong> to look like this<br>
<br>
<div class="syntaxhighlighter  " id="highlighter_405000"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_405000_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_405000" menu="false" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="keyword bold">case</code> <code class="plain">3:</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="comments">//Save to a .bmp file called MyCapture.bmp</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">LPSTR</code> <code class="plain">filename =(</code><code class="color1 bold">LPSTR</code><code class="plain">)</code><code class="string">"MyCapture.bmp"</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd,WM_CAP_FILE_SAVEDIB, 0, (</code><code class="color1 bold">LPARAM</code><code class="plain">) filename);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd,WM_CAP_DRIVER_CONNECT,0,0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_SET_SCALE, </code><code class="keyword bold">true</code> <code class="plain">, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_SET_PREVIEWRATE, 66, 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SendMessage(camhwnd, WM_CAP_SET_PREVIEW, </code><code class="keyword bold">true</code> <code class="plain">, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div></div></div><br>
<br>
You can delete the overhead functions <br>
<strong class="bbc">void CreateBMPFile</strong><br>
and<br>
<strong class="bbc">PBITMAPINFO CreateBitmapInfoStruct</strong><br>
<br>
Best Wishes Snoopy
<br>
</div>
</div>
<div class="rep_bar clear right" id="rep_post_1393151"><span style="float: left; margin-top: 10px; font-weight: bold;">
Was This Post Helpful?
</span>
<span class="reputation zero rep_show clickable" title="Reputation" onclick="ipb.topic.repPopUp( this, 1393151 );">
0
</span>
<ul>
<li><a href="#" class="rep_up" title="Vote this post up"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/add.png" alt="+"></a></li>
<li><a href="#" class="rep_down" title="Vote this post down"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/delete.png" alt="-"></a></li>
</ul>
</div>
<script type="text/javascript">
					ipb.global.registerReputation( 'rep_post_1393151', { app: 'forums', type: 'pid', typeid: '1393151' }, parseInt('0') );
				</script>
<ul class="post_controls">
<li class="top hide"><a href="#top" class="top" title="Back to top">Back to top</a></li>
<li class="multiquote" id="multiq_1393151" style="">
<a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1393151" title="Quote this post with Multi-Quote"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> MultiQuote</a>
</li>
<li><a href="http://www.dreamincode.net/forums/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=48&amp;t=193519&amp;qpid=1393151" title="Reply directly to this post"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/comment_add.png" alt="Reply Icon"> Quote + Reply</a></li>
</ul>
<script type="text/javascript">
					// Show multiquote for JS browsers
					$('multiq_1393151').show();
					
					if( $('toggle_post_1393151') )
					{
						$('toggle_post_1393151').show();
					}
				</script>
</div>
</div>
<hr>
<ul class="topic_jump right clear">
<li class="previous"><a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__old">&#8592; Previous Topic</a></li>
<li><strong><a href="http://www.dreamincode.net/forums/forum/48-c-tutorials/" title="Return to C++ Tutorials">C++ Tutorials</a></strong></li>
<li class="next"><a href="http://www.dreamincode.net/forums/topic/193519-win32-webcam-program/page__view__new">Next Topic &#8594;</a></li>
</ul>
<div class="topic_controls clear">
<span class="pagination no_pages left">Page 1 of 1</span>
</div>
</div>
<br class="clear">
</div>
<table width="100%" align="center" cellpadding="0" cellspacing="0">
<tbody><tr>
<td valign="top" align="center">
<script language="JavaScript">
				  GA_googleFillSlotWithSize("ca-pub-9822709549810875", "DIC_300x250_Footer_Default", 300, 250 ); 
				  // Notice the pub ID and slot size added to the call
				</script>
</td>
<td valign="top" width="100%" align="left">
<div id="related" style="margin-top: -25px;">
<style>
		.related ul { list-style-type: circle; font-size: 12px; font-weight: bold; }
        .related li { margin-bottom: 5px; background-position: left 7px !important; margin-left: -35px; }
		.related h2 { font-size: 18px; font-weight: bold; }
		.related a { color: blue; }
		</style>
<div class="related">
<h2>Related C++ Topics<sup>beta</sup></h2><ul><li><a href="http://www.dreamincode.net/forums/topic/219703-access-webcam-using-cc-and-take-an-image/" title="2 Replies - Topic Started: March 2, 2011, 12:40 am" '="">Access WEBCAM Using C\C++ And Take An Image</a> </li><li><a href="http://www.dreamincode.net/forums/topic/196878-win32-object-oriented-programming/" title="3 Replies - Topic Started: October 26, 2010, 4:45 pm" '="">Win32 / Object Oriented Programming - Very Simplistic Win32 Program Without Console. / Applying C++</a> </li><li><a href="http://www.dreamincode.net/forums/topic/62843-need-some-help-with-a-basic-win32-api-program/" title="22 Replies - Topic Started: September 5, 2008, 8:17 pm" '="">Need Some Help With A Basic Win32 Api Program</a> </li><li><a href="http://www.dreamincode.net/forums/topic/226887-print-the-output-of-c-program-to-printer/" title="10 Replies - Topic Started: April 10, 2011, 5:59 am" '="">Print The Output Of C++ Program To Printer</a> </li><li><a href="http://www.dreamincode.net/forums/topic/23807-newbie-question-problem-defining-ofstream/" title="10 Replies - Topic Started: February 10, 2007, 5:38 pm" '="">Newbie Question : Problem Defining Ofstream - Problem Defining Ofstream In Win32 C++ Program</a> </li><li><a href="http://www.dreamincode.net/forums/topic/64755-coloured-text-console/" title="4 Replies - Topic Started: September 23, 2008, 3:47 am" '="">Coloured Text - Console - How Do You Colour Text In Win32 Console?</a> </li><li><a href="http://www.dreamincode.net/forums/topic/73663-system-command-cinget/" title="33 Replies - Topic Started: November 26, 2008, 7:50 pm" '="">System Command &amp; Cin.get?</a> </li><li><a href="http://www.dreamincode.net/forums/topic/91857-simple-game-of-life-implementation/" title="24 Replies - Topic Started: March 10, 2009, 4:45 pm" '="">Simple Game Of Life Implementation</a> </li><li><a href="http://www.dreamincode.net/forums/topic/69395-cant-get-systray-icon-menu-working/" title="1 Replies - Topic Started: October 28, 2008, 6:33 pm" '="">Can't Get Systray Icon Menu Working</a> </li><li><a href="http://www.dreamincode.net/forums/topic/120082-intercept-a-wm-message-into-a-c-class/" title="2 Replies - Topic Started: August 13, 2009, 11:37 pm" '="">Intercept A WM Message Into A C++ Class</a> </li></ul></div>	</div>
</td>
</tr>
</tbody></table>
<script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/lightbox.js"></script>
<script type="text/javascript">
//<![CDATA[
	// Lightbox Configuration
	LightboxOptions = Object.extend({
	    fileLoadingImage:        'http://cdn2.dreamincode.net/dreamincode/forums/public/style_images/master/lightbox/loading.gif',     
	    fileBottomNavCloseImage: 'http://cdn2.dreamincode.net/dreamincode/forums/public/style_images/master/lightbox/closelabel.gif',
	    overlayOpacity: 0.8,   // controls transparency of shadow overlay
	    animate: true,         // toggles resizing animations
	    resizeSpeed: 7,        // controls the speed of the image resizing animations (1=slowest and 10=fastest)
	    borderSize: 10,         //if you adjust the padding in the CSS, you will need to update this variable
		// When grouping images this is used to write: Image # of #.
		// Change it for non-english localization
		labelImage: "Image",
		labelOf: "of"
	}, window.LightboxOptions || {});
/* Watch for a lightbox image and set up our downloadbutton watcher */
document.observe('click', (function(event){
    var target = event.findElement('a[rel^=lightbox]') || event.findElement('area[rel^=lightbox]');
    if (target) {
        event.stop();
        gbl_addDownloadButton();
    }
}).bind(this));
var _to    = '';
var _last  = '';
function gbl_addDownloadButton()
{
	if ( typeof( ipsLightbox.lightboxImage ) != 'undefined' && ipsLightbox.lightboxImage.src )
	{
		if ( _last != ipsLightbox.lightboxImage.src )
		{
			if ( ! $('gbl_d') )
			{
				$('bottomNav').insert( { top: "<div id='gbl_d' style='text-align:right;padding-bottom:4px;'></div>" } );
			}
			
			$('gbl_d').update( "<a href='"+ ipsLightbox.lightboxImage.src + "' target='_blank'><img src='http://cdn2.dreamincode.net/dreamincode/forums/public/style_images/master/lightbox/download-icon.png' /></a>" );
			
			_last = ipsLightbox.lightboxImage.src;
		}
	}
	
	/* Check for init and then keep checking for new image */
	_to = setTimeout( "gbl_addDownloadButton()", 1000 );
}
//]]>
</script>
</div>
</div>
</div>
<div id="sidebar">
<div style="margin-left: 35px; padding-top: 10px; text-align: center;">
<a href="http://www.dreamincode.net/forums/index.php?app=core&amp;module=global&amp;section=register&amp;coppa_user=&amp;termsread=1&amp;coppa_pass=1&amp;agree_to_terms=1"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/ask_a_question_336.png"></a>
<br><br>
<div style="width: 300px; height: 250px; margin-left: 25px;">
<script type="text/javascript">
//<![CDATA[
ord = window.ord || Math.floor(Math.random()*1E16);
document.write('<script type="text/javascript" src="http://ad2.netshelter.net/adj/ns.dreamincode/general;ppos=atf;kw=;tile=2;sz=300x250;ord=' + ord + '?"><\/script>');
//]]>
</script><script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/general.js"></script>
<noscript><a href="http://ad2.netshelter.net/jump/ns.dreamincode/general;ppos=atf;kw=;tile=2;sz=300x250;ord=123456789?" target="_blank"><img src="http://ad2.netshelter.net/ad/ns.dreamincode/general;ppos=atf;kw=;tile=2;sz=300x250;ord=123456789?" border="0" alt=""/></a></noscript>
</div>
</div>
<div id="sidebar_inner">
<div class="column1">
<div class="navigation">
<h2><a href="http://www.dreamincode.net/forums/forum/72-general-discussion/">General Discussion</a></h2>
<ul class="navigation">
<li><a href="http://www.dreamincode.net/forums/forum/1-caffeine-lounge/" title="This is our off-topic forum for discussions related to non-programming topics including: sports, current events, games, music, movies, food, drink, TV, geek related (toys &amp; technology), debates, life events, rants, and occasionally religion and politics. ">Caffeine Lounge</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/93-corner-cubicle/" title="Off-Topic discussion of IT related topics. This is the forum for professionals and those interested in serious discussion of topics related to the world of IT. It all happens here in the corner cubicle. ">Corner Cubicle</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/110-student-campus/" title="A forum just for students. Talk about colleges, classes, resources for students, homework, and other topics related to life in school. ">Student Campus</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/82-software-development/" title="Discuss topics related to developing software. Including architecture, design patterns, documentation, software industry, and other non-language specific programming topics. ">Software Development</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/83-industry-news/" title="A place for topics that announce various news from the web/software development industry (product release announcements, updates, new services etc.)">Industry News</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/65-introduce-yourself/" title="A place where you can introduce yourself to the community and greet other new members.">Introduce Yourself</a></li>
</ul>
<h2><a href="http://www.dreamincode.net/forums/forum/76-programming-help/">Programming Help</a></h2>
<ul class="navigation">
<li><a href="http://www.dreamincode.net/forums/forum/15-c-and-c/" title="Expert programming help for C, and C++! Ask questions about homework assignments, or any other C/C++ related problems. C++ is a great language when beginning programming. ">C and C++</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/21-vb6/" title="Our Visual Basic experts are happy to help with homework assignments, commercial applications, or any other VB question you may have! Visual Basic is good to learn programming. ">VB6</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/32-java/" title="Post your Java questions in here. We're happy to help with homework assignments, work projects, or any other java related questions. Java is common when beginning computer programming.">Java</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/67-vbnet/" title="Ask questions about Microsoft's VB.NET programming language.">VB.NET</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/84-c/" title="Object Oriented Programming at its finest. Encompassing power with ease of use, C# has become one of the top programming languages of the new age.">C#</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/30-aspnet/" title="Having some problems with ASP.NET programming? Pop in here and ask your question!">ASP.NET</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/142-net-framework/" title="">.NET Framework</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/28-php/" title="Having some PHP problems? Need some help with a few functions? This is the place to ask! ">PHP</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/70-ruby/" title="This up-and-coming language is easy to learn, fast to develop, and very powerful. Get help with the Ruby on Rails framework or any other Ruby questions you have!">Ruby</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/29-python/" title="">Python</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/31-coldfusion/" title="It's the other white meat... a rapid application development language that will have you hooked in no time! From cfoutput to components, we can help you out!">ColdFusion</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/14-databases/" title="mySQL, PostgreSQL, Access, SQL, and Oracle... you've got a database question... we've got database answers!">Databases</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/62-other-languages/" title="Discuss languages that don't have a specific forum. Including COBOL, Fortran, ADA, Basic, etc. ">Other Languages</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/69-game-programming/" title="Get help with all things game programming related. OpenGL, DirectX, 3D Engines, etc.">Game Programming</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/109-mobile-development/" title="Discuss developing applications for mobile phones. Including Android, iPhone, and other mobile platforms. ">Mobile Development</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/126-52-weeks-of-code/" title="">52 Weeks Of Code</a></li>
</ul>
<h2><a href="http://www.dreamincode.net/forums/forum/74-web-development/">Web Development</a></h2>
<ul class="navigation">
<li><a href="http://www.dreamincode.net/forums/forum/63-web-development/" title="Discuss anything that doesn't fit in the other web development forums.">Web Development</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/4-html-css/" title="Have questions about HTML, XHTML, CSS? We'll get you headed in the right direction! ">HTML &amp; CSS</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/90-javascript/" title="JavaScript and AJAX, it's what Web 2.0 is all about. Post your JavaScript related questions here!">JavaScript</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/3-graphic-design/" title="Photoshop and Corel gurus come on in! Can't figure out how to do that cool effect? Have some questions or cool web images you've made? Post em' here">Graphic Design</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/8-flash-actionscript/" title="Let our Flash and ActionScript experts answer your questions. From simple tweens to advanced flash remoting, we're happy to help!">Flash &amp; ActionScript</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/89-blogging/" title="Wordpress, Blogger, Plugins, Themes, Skins, Pay Per Post, and anything else related to the Blogging industry. ">Blogging</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/59-seo-advertising/" title="Advertising, SEO, AdSense, AdWords, Link Trades, and more! Now that you've created your website, you've gotta drive traffic to it. Discuss current trends and techniques here. ">SEO &amp; Advertising</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/88-web-servers-hosting/" title="Apache, IIS, Shared Hosting, Dedicated Hosting, Colocation. We'll make sure you get your site online and keep it online!">Web Servers &amp; Hosting</a></li>
<li><a href="http://www.dreamincode.net/forums/forum/5-site-check/" title="Post your web site to be reviewed by fellow dream.in.code members. ">Site Check</a></li>
</ul>
<script language="JavaScript">
				  GA_googleFillSlotWithSize("ca-pub-9822709549810875", "DIC_160x600_Left_Default", 160, 600 ); 
				  // Notice the pub ID and slot size added to the call
				</script>
<br>
</div>
</div><div class="column2">
<div class="tutorials" style="margin-top: -15px;">
<h2>Follow &amp; Share</h2>
<a href="http://www.dreamincode.net/rss/featured.php" rel="alternate"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/feed-icon32x32.png" alt="Dream.In.Code RSS Feed" style="border: 0pt none; margin: 2px;" width="32" height="32"></a>
<a href="http://www.linkedin.com/e/gis/1506187" rel="alternate"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/linkedin-icon32x32.png" alt="Dream.In.Code LinkedIn Group" style="border: 0pt none; margin: 2px;" width="32" height="32"></a>
<a href="http://www.twitter.com/dreamincode" rel="alternate"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/twitter-icon32x32.png" alt="Follow Us On Twitter" style="border: 0pt none; margin: 2px;" width="32" height="32"></a>
<a href="http://www.facebook.com/pages/DreamInCode/62219401412" rel="alternate"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/facebook.png" alt="Fan Us On Facebook" style="border: 0pt none; margin: 2px;" width="32" height="32"></a>
<p><a href="http://feeds.feedburner.com/dic_featured"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/dic_featured.gif" style="border: 0pt none; margin-top: 2px; margin-left: 3px;" alt="" width="88" height="26"></a></p>
<h2>Celebrate &amp; Win!</h2>
<a href="http://www.dreamincode.net/forums/topic/247091-dreamincode-10th-birthday500k-members-contest/"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/10yr_170x200.jpg"></a>
<h2><a href="http://www.dreamincode.net/forums/showforum48.htm">C++ Tutorials</a></h2>
<ul>
<li><a href="http://www.dreamincode.net/forums/topic/243971-do-while0;/">do {} while(0);</a></li>
<li><a href="http://www.dreamincode.net/forums/topic/242608-detect-windows-version-with-win-api/">Detect Windows Version With WIN API</a></li>
<li><a href="http://www.dreamincode.net/forums/topic/239347-static-functions-and-variables-in-c/">Static Functions and Variables in C</a></li>
<li><a href="http://www.dreamincode.net/forums/topic/238977-c-memory-management-techniques/">C Memory Management Techniques</a></li>
<li><a href="http://www.dreamincode.net/forums/topic/236592-c-introduction-to-references/">C++ : Introduction to References</a></li>
<li><a href="http://www.dreamincode.net/forums/topic/234775-creating-a-recursive-descent-parser-oop-style/">Creating a recursive descent parser, OOP style</a></li>
<li><a href="http://www.dreamincode.net/forums/topic/232120-calling-assembly-routines-from-c/">Calling assembly routines from C</a></li>
<li><a href="http://www.dreamincode.net/forums/topic/231075-everything-you-needed-to-know-about-the-stack-but-darent-ask/">Everything You Needed To Know About The Stack But Daren't Ask</a></li>
<li><a href="http://www.dreamincode.net/forums/topic/230020-evolutionary-algorithms-genetic-algorithms/">Evolutionary Algorithms / Genetic Algorithms</a></li>
<li><a href="http://www.dreamincode.net/forums/topic/228811-microsoft-using-console-functions-to-achieve-blinking-text/">Microsoft : Using Console Functions To Achieve Blinking Text</a></li>
<li><a href="http://www.dreamincode.net/forums/showforum48.htm"><strong>315 More C++ Tutorials...</strong></a></li>	</ul>
<h2>Reference Sheets</h2>
<a href="http://www.dreamincode.net/forums/showtopic17947.htm"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/refsheets5.png" width="151" height="157"></a>
<h2><a href="http://www.dreamincode.net/code/browse.php?cid=2">C++ Snippets</a></h2>
<ul>
<li><a href="http://www.dreamincode.net/code/snippet82.htm">Linked List Class</a></li>
<li><a href="http://www.dreamincode.net/code/snippet279.htm">Insertion Sort Example</a></li>
<li><a href="http://www.dreamincode.net/code/snippet80.htm">Recursive Fibonacci Sequence</a></li>
<li><a href="http://www.dreamincode.net/code/snippet39.htm">Convert cases of strings</a></li>
<li><a href="http://www.dreamincode.net/code/snippet693.htm">integer to string conversion</a></li>
<li><a href="http://www.dreamincode.net/code/snippet693.htm">C++ Int to String</a></li>
<li><a href="http://www.dreamincode.net/code/snippet77.htm">Getting Current Directory</a></li>
<li><a href="http://www.dreamincode.net/code/snippet244.htm">Finding Square Root without using sqrt()</a></li>
<li><a href="http://www.dreamincode.net/code/snippet313.htm">Shortest Function to Reverse a String ( Uses Recursion )</a></li>
<li><a href="http://www.dreamincode.net/code/snippet884.htm">C++ calculator</a></li>
<li><a href="http://www.dreamincode.net/code/browse.php?cid=2"><strong>909 More C++ Snippets...</strong></a></li></ul>
<h2><a rel="nofollow" href="http://www.dreamincode.net/?p=chat">DIC Chatroom</a></h2>
<ul><li><a rel="nofollow" href="http://www.dreamincode.net/?p=chat">Join our IRC Chat</a></li></ul>
<h2>Bye Bye Ads</h2>
<a rel="nofollow" href="http://www.dreamincode.net/forums/index.php?act=paysubs&amp;CODE=index"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/dicpp.gif" width="141" height="32"></a>
<h2>Monthly Drawing</h2>
<a href="http://www.dreamincode.net/forums/index.php?showtopic=19383" rel="nofollow"><img alt="Thumb Drive" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/monthlygiveaway.gif" width="130" height="77"></a>
</div>
</div><div style="padding-left: 50px; position: relative; clear: both;">
<iframe src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/likebox.htm" style="border: medium none; overflow: hidden; width: 300px; height: 287px;" allowtransparency="true" frameborder="0" scrolling="no"></iframe>
</div>
</div>
</div>
</div>
<div id="footer">
<br><br>
<a href="http://lakequincy.com/" title="Advertise on this site through Lake Quincy Media" target="_blank"><img class=" bgcerjvdhuxxdqycugpu" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/LQM_advertise_here_button.gif" alt="Advertise on this site through Lake Quincy Media" style="float: right;" width="135" height="90" align="right" border="0"></a>
<div align="center">
<strong><a href="http://www.dreamincode.net/forums/index.php?showannouncement=22">FAQ</a> | <a href="http://www.dreamincode.net/forums/blog/1081-dreamincode-team-blog/">Team Blog</a> | <a href="http://www.dreamincode.net/forums/forum/106-site-questions-support/">Feedback/Support</a> | <a href="http://www.dreamincode.net/downloads/MediaKit.pdf" rel="nofollow">Advertising</a><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/pdf.gif" valign="middle" border="0"> | <a href="http://www.dreamincode.net/?p=tos" rel="nofollow">Terms of Use</a> | <a href="http://www.dreamincode.net/?p=privacy" rel="nofollow">Privacy Policy</a> | <a href="http://www.dreamincode.net/?p=about" rel="nofollow">About Us</a>
</strong></div><strong>
<br>
<br>
<div align="center">Copyright 2001-2011 <a href="http://www.mediagroup1.com/" rel="nofollow"><b>MediaGroup1 LLC</b></a>, All Rights Reserved<br>A <a href="http://www.mediagroup1.com/" rel="nofollow"><b>MediaGroup1 LLC</b></a> Production - Version 6.0.2.1.36<br>Server: secure3</div>
</strong></div><strong>
<script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/thickbox.js"></script>
<script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/jsapi"></script>
<script type="text/javascript">
google.load('search', '1',{nocss: true});
jQuery(document).ready(function() {
	jQuery("#cse-search-box").submit(function () {
	var customSearchControl = new google.search.CustomSearchControl('000872085005376217422:zamd_7elal4');
	customSearchControl.setLinkTarget(google.search.Search.LINK_TARGET_SELF);
	tb_show("Dream.In.Code Search Results - Powered By <img src='http://www.google.com/cse/images/google_custom_search_smwide.gif'>", "#TB_inline?height=480&width=800");
	var drawOptions = new google.search.DrawOptions();
	customSearchControl.draw(document.getElementById("TB_ajaxContent"), drawOptions);
	customSearchControl.execute(document.getElementById("query").value);
	return false;
	});
});
</script><script src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/a" type="text/javascript"></script><script src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/defaulten.js" type="text/javascript"></script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69851-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type="text/javascript">
_qoptions={
qacct:"p-d4Szpdj6xMw-o"
};
</script>
<script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/quant.js"></script>
<noscript>
<img src="http://pixel.quantserve.com/pixel/p-d4Szpdj6xMw-o.gif" style="display: none;" border="0" height="1" width="1" alt="Quantcast"/>
</noscript>
<script src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/a_002" type="text/javascript"></script>
<script type="text/javascript" language="Javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/m.js"></script>
<script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/dreamincode.js"></script>
<div style="top: 0px; left: 0px; position: absolute;" id="ad_728_pre">
<script type="text/javascript">
	//<![CDATA[
	ord = window.ord || Math.floor(Math.random()*1E16);
	document.write('<script type="text/javascript" src="http://ad2.netshelter.net/adj/ns.dreamincode/general;ppos=atf;kw=;tile=1;dcopt=ist;sz=728x90;ord=' + ord + '?"><\/script>');
	//]]>
	</script><script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/general_002.js"></script>
<noscript><a href="http://ad2.netshelter.net/jump/ns.dreamincode/general;ppos=atf;kw=;tile=1;sz=728x90;ord=123456789?" target="_blank"><img src="http://ad2.netshelter.net/ad/ns.dreamincode/general;ppos=atf;kw=;tile=1;sz=728x90;ord=123456789?" border="0" alt=""/></a></noscript>
</div>
<script type="text/javascript">
function showAds() {
if (jQuery("#ad_header").length > 0) {
var divHold = jQuery("#ad_header");
var position = divHold.offset();
jQuery("#ad_728_pre").css(
{'top' : position.top + 'px', 'left' : position.left+'px', 'position' : 'absolute'}
);
jQuery("#ad_728_pre").show();
};
} 

jQuery(document).ready(function(){
showAds();
});
</script>
</strong></div><strong>
<script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/shCore.js"></script>
<script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/shBrushBash.js"></script>
<script type="text/javascript">
jQuery(function(){
  jQuery('pre').removeClass('brush: bash').addClass('brush: cpp');
});
</script>
<script type="text/javascript" src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/shBrushCpp.js"></script>
<link rel="stylesheet" type="text/css" href="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/shCore.css">
<script type="text/javascript">
                SyntaxHighlighter.config.clipboardSwf = 'http://cdn2.dreamincode.net/dreamincode/syntax/scripts/clipboard.swf';
		SyntaxHighlighter.all();
	</script>

</strong><div style="display: none;" id="overlay"></div><div style="display: none;" id="lightbox"><div style="width: 250px; height: 250px;" id="outerImageContainer"><div id="imageContainer"><img id="lightboxImage"><div id="hoverNav"><a id="prevLink" href="#"></a><a id="nextLink" href="#"></a></div><div id="loading"><a id="loadingLink" href="#"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/loading.gif"></a></div></div></div><div id="imageDataContainer"><div id="imageData"><div id="imageDetails"><span id="caption"></span><span id="numberDisplay"></span></div><div id="bottomNav"><a id="bottomNavClose" href="#"><img src="Win32%20WebCam%20Program%20-%20C++%20Tutorials%20_%20Dream.In.Code_files/closelabel.gif"></a></div></div></div></div></body></html>